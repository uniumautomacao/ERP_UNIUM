# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  DeviceScreen:
    Properties:
      Fill: =RGBA(255, 255, 255, 1)
      LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    Children:
      - DeviceScreenContainer:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            Height: =Parent.Height
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =5
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            Width: =Parent.Width
            Y: |
              =0
          Children:
            - DeviceScreenCommandBar:
                Control: CodeComponent
                ComponentName: cat_PowerCAT.CommandBar
                Properties:
                  Height: =40
                  Items: |-
                    =Table(
                        {
                            ItemKey: "Back",
                            ItemIconName: "ChevronLeft",
                            ItemDisplayName: "Voltar"
                        },
                        {
                            ItemKey: "PrintAll",
                            ItemIconName: "Print",
                            ItemDisplayName: "Imprimir " & SelectedConnectionTab.Option,
                            ItemFarItem: true
                        },
                        {
                            ItemKey: "Settings",
                            ItemIconName: "Settings",
                            ItemDisplayName: "",
                            ItemFarItem: true
                        }
                    )
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  OnSelect: |-
                    =Switch(
                        Self.Selected.ItemKey,
                        "Back",
                        Back(),
                        "PrintAll",
                        UpdateContext({SpinCounter: SpinCounter + 1});
                        ForAll(
                            Filter(
                                ConnectionsGallery.AllItems As Item,
                                Or(
                                    !IsBlank(Item.'Connected To'.'Device IO Connection'),
                                    Len(TrimEnds(Item.'Connected To (Manual)')) > 0
                                )
                            ) As Item,
                            With(
                                LookUp(
                                    'Device IO Connections' As Con,
                                    Con.'Device IO Connection' = Item.'Device IO Connection'
                                ) As Con,
                                If(
                                    And(
                                        Or(
                                            !IsBlank(Con.'Connected To'),
                                            !IsBlank(Con.'Connected To (Manual)'),
                                            Len(Con.'Connected To (Manual)') > 0
                                        ),
                                        Not(
                                            And(
                                                Con.'Tipo de Conexão' = 'Tipo de Conexão'.Speaker,
                                                Con.Direção = 'Direção de Conexão'.Output,
                                                Not(
                                                    Con.'Device IO Connection' in Distinct(
                                                        ConsCol As ColCon,
                                                        ColCon.local_rootcon
                                                    )
                                                )
                                            )
                                        )
                                    ),
                                    '(ImpressãodeEtiqueta)-Imprimiretiquetadecabo'.Run(
                                        Con.Device.Name & " - " & Con.Name,
                                        If(
                                            IsBlank(Con.'Connected To'),
                                            Con.'Connected To (Manual)',
                                            If(
                                                And(
                                                    Con.'Tipo de Conexão' = 'Tipo de Conexão'.Speaker,
                                                    Con.Direção = 'Direção de Conexão'.Input
                                                ),
                                                With(
                                                    LookUp(
                                                        ConsCol As ColCon,
                                                        ColCon.new_deviceioconnectionid = Con.'Device IO Connection'
                                                    ) As IndexedConInfo,
                                                    LookUp(
                                                        'Device IO Connections' As RootCon,
                                                        RootCon.'Device IO Connection' = IndexedConInfo.local_rootcon,
                                                        RootCon.Device.Name & " - " & RootCon.Name & " | " & RootCon.Localização
                                                    )
                                                ),
                                                If(
                                                    And(
                                                        Con.'Tipo de Conexão' = 'Tipo de Conexão'.Speaker,
                                                        Con.Direção = 'Direção de Conexão'.Output,
                                                        Con.'Device IO Connection' in Distinct(
                                                            ConsCol As ColCon,
                                                            ColCon.local_rootcon
                                                        )
                                                    ),
                                                    With(
                                                        {
                                                            Value: Distinct(
                                                                Filter(
                                                                    ConsCol As ColCon,
                                                                    ColCon.local_rootcon = Con.'Device IO Connection',
                                                                    ColCon.new_deviceioconnectionid <> Con.'Device IO Connection'
                                                                )As Nei,
                                                                Nei.new_deviceioconnectionid
                                                            )
                                                        } As NeighborConsIds,
                                                        Concat(
                                                            Filter(
                                                                'Device IO Connections' As Con,
                                                                Con.'Device IO Connection' in NeighborConsIds.Value
                                                            ) As Con,
                                                            Con.Device.Name,
                                                            "+"
                                                        )
                                                    ),
                                                    LookUp(
                                                        'Device IO Connections' As Con2,
                                                        Con2.'Device IO Connection' = Con.'Device IO Connection',
                                                        Con2.'Connected To'.Device.Name & " - " & Con2.'Connected To'.Name & " | " & Con2.'Connected To'.Localização
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        );
                        UpdateContext({SpinCounter: SpinCounter - 1}),
                        "Settings",
                        UpdateContext(
                            {
                                SettingsSelected: If(
                                    SettingsSelected = true,
                                    false,
                                    true
                                )
                            }
                        ),
                        false
                    )
                  Theme: =AppThemeJson
                  Width: =480.99
                  X: =0.00
                  Y: =-51.16
            - DeviceScreenTitleTextInput:
                Control: TextInput@0.0.54
                Properties:
                  FontSize: =16
                  FontWeight: =FontWeight.Bold
                  Height: =35
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  OnChange: |-
                    =Patch(
                        'Device IO',
                        {
                            DeviceIO: SelectedDevice.DeviceIO,
                            Name: Self.Value
                        }
                    )
                  Placeholder: =
                  TriggerOutput: ='TextInputCanvas.TriggerOutput'.FocusOut
                  Value: |-
                    =LookUp(
                        'Device IO' As D,
                        D.DeviceIO = SelectedDevice.DeviceIO,
                        Coalesce(
                            D.Name,
                            D.'Modelo de Produto'.Referência
                        )
                    )
            - DeviceScreenLocationTextInput:
                Control: TextInput@0.0.54
                Properties:
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  OnChange: |-
                    =Patch(
                        'Device IO',
                        {
                            DeviceIO: SelectedDevice.DeviceIO,
                            Localização: Self.Value
                        }
                    )
                  Placeholder: ="Defina a localização"
                  Value: |-
                    =LookUp(
                        'Device IO' As D,
                        D.DeviceIO = SelectedDevice.DeviceIO,
                        D.Localização
                    )
            - ConnectionsTabsPivot:
                Control: CodeComponent
                ComponentName: cat_PowerCAT.Pivot
                Properties:
                  Height: =45
                  ItemDisplayName: ="DisplayName"
                  Items: =ConnectionsTabs
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  Theme: =AppThemeJson
                Children:
                  - DisplayName3_1:
                      Control: DataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="DisplayName"
                        FieldName: ="DisplayName"
                        FieldType: ="s"
                        Order: =1
                  - Option1_1:
                      Control: DataField@1.5.0
                      Variant: textualColumn
                      IsLocked: true
                      Properties:
                        FieldDisplayName: ="Option"
                        FieldName: ="Option"
                        FieldType: ="l"
                        Order: =2
            - ConnectionsGallery:
                Control: Gallery@2.15.0
                Variant: BrowseLayout_Vertical_ThreeTextVariant_pcfCore
                Properties:
                  BorderColor: =RGBA(166, 166, 166, 1)
                  Fill: =ColorValue(AppTheme.palette.neutralLighter)
                  FocusedBorderColor: =RGBA(0, 120, 212, 1)
                  FocusedBorderThickness: =2
                  Height: =(Self.AllItemsCount*95)+10
                  Items: |-
                    =SortByColumns(
                        Filter(
                            'Device IO Connections' As C,
                            C.Device.DeviceIO = SelectedDevice.DeviceIO,
                            C.'Tipo de Conexão' = SelectedConnectionTab.Option
                        ),
                        "new_tipodeconexao",
                        SortOrder.Ascending,
                        "new_name",
                        SortOrder.Ascending
                    )
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  OnSelect: =
                  TemplatePadding: =5
                  TemplateSize: =90
                  Width: =406
                  WrapCount: =RoundUp(Self.Width/500,0)
                Children:
                  - Rectangle2_1:
                      Control: Rectangle@2.3.0
                      Properties:
                        BorderColor: =ColorValue(AppTheme.palette.neutralLight)
                        BorderThickness: =1
                        DisabledFill: =RGBA(0,0,0,0)
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =RGBA(0, 120, 212, 1)
                        Height: =Parent.TemplateHeight
                        HoverFill: =RGBA(0,0,0,0)
                        OnSelect: =Select(Parent)
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Width: =Parent.TemplateWidth
                  - ConnectionTemplateContainer:
                      Control: GroupContainer@1.4.0
                      Variant: AutoLayout
                      Properties:
                        Fill: =ColorValue(AppTheme.palette.white)
                        Height: =Parent.TemplateHeight
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        PaddingLeft: =10
                        PaddingRight: =10
                        Width: =Parent.TemplateWidth
                      Children:
                        - ConnectionTitleContainer:
                            Control: GroupContainer@1.4.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutMaxHeight: =
                              LayoutMaxWidth: =
                              LayoutMinHeight: =
                            Children:
                              - ConnectionNameLabel:
                                  Control: FluentV8/Label@1.8.6
                                  Properties:
                                    FillPortions: =1
                                    FontWeight: =FontWeight.Semibold
                                    Height: =24
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: =
                                    TabIndex: =-1
                                    Text: =ThisItem.Name
                                    VerticalAlignment: =VerticalAlign.Middle
                                    Width: =
                                    X: =12
                                    Y: =
                              - ConnectionTypeLabel:
                                  Control: FluentV8/Label@1.8.6
                                  Properties:
                                    Alignment: =Align.Right
                                    FillPortions: =1
                                    FontWeight: =FontWeight.Normal
                                    Height: =24
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: =
                                    TabIndex: =-1
                                    Text: =ThisItem.'Tipo de Conexão'
                                    VerticalAlignment: =VerticalAlign.Middle
                                    Width: =
                                    X: =12
                                    Y: =
                              - RemoveConnectionIcon:
                                  Control: CodeComponent
                                  ComponentName: cat_PowerCAT.Icon
                                  Properties:
                                    IconColor: ="darkred"
                                    IconName: ="DeleteRows"
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinHeight: =0
                                    OnChange: |
                                      =With(
                                          LookUp(
                                              'Device IO Connections' As C,
                                              C.'Device IO Connection' = ThisItem.'Device IO Connection'
                                          ) As SelectedConnectionForEdit,
                                          If(
                                              SelectedConnectionForEdit.Direção in [
                                                  'Direção de Conexão'.Input,
                                                  'Direção de Conexão'.Output,
                                                  'Direção de Conexão'.Bidirectional
                                              ],
                                              Unrelate(
                                                  LookUp(
                                                      'Device IO Connections' As C,
                                                      C.'Device IO Connection' = SelectedConnectionForEdit.'Connected To'.'Device IO Connection'
                                                  ).'Device IO Connections (new_new_deviceioconnection_ConnectedTo_new_de)',
                                                  LookUp(
                                                      'Device IO Connections' As C,
                                                      C.'Device IO Connection' = SelectedConnectionForEdit.'Connected To'.'Device IO Connection'
                                                  )
                                              )
                                          );
                                          Unrelate(
                                              LookUp(
                                                  'Device IO Connections' As C,
                                                  C.'Device IO Connection' = SelectedConnectionForEdit.'Device IO Connection'
                                              ).'Device IO Connections (new_new_deviceioconnection_ConnectedTo_new_de)',
                                              LookUp(
                                                  'Device IO Connections' As C,
                                                  C.'Device IO Connection' = SelectedConnectionForEdit.'Device IO Connection'
                                              )
                                          );
                                          Remove(
                                              'Device IO Connections',
                                              SelectedConnectionForEdit
                                          )
                                      );
                                    TextAlignment: ='PowerCAT.Icon.TextAlignment'.Right
                                    Theme: =AppThemeJson
                                    Visible: =RemoveDeviceButton.Visible
                                    Width: =Self.Height
                              - PrintCableLabelButtonCanvas:
                                  Control: Button@0.0.45
                                  Properties:
                                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                                    DisplayMode: |-
                                      =If(
                                          Or(
                                              !IsBlank(ThisItem.'Connected To'.'Device IO Connection'),
                                              Len(TrimEnds(ThisItem.'Connected To (Manual)')) > 0
                                          ),
                                          DisplayMode.Edit,
                                          DisplayMode.Disabled
                                      )
                                    Icon: ="Print"
                                    Layout: ='ButtonCanvas.Layout'.IconOnly
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinHeight: =0
                                    OnSelect: |-
                                      =UpdateContext({SpinCounter: SpinCounter + 1});
                                      With(
                                          LookUp(
                                              'Device IO Connections' As Con,
                                              Con.'Device IO Connection' = ThisItem.'Device IO Connection'
                                          ) As Con,
                                          If(
                                              And(
                                                  Or(
                                                      !IsBlank(Con.'Connected To'),
                                                      !IsBlank(Con.'Connected To (Manual)'),
                                                      Len(Con.'Connected To (Manual)') > 0
                                                  ),
                                                  Not(
                                                      And(
                                                          Con.'Tipo de Conexão' = 'Tipo de Conexão'.Speaker,
                                                          Con.Direção = 'Direção de Conexão'.Output,
                                                          Not(
                                                              Con.'Device IO Connection' in Distinct(
                                                                  ConsCol As ColCon,
                                                                  ColCon.local_rootcon
                                                              )
                                                          )
                                                      )
                                                  )
                                              ),
                                              '(ImpressãodeEtiqueta)-Imprimiretiquetadecabo'.Run(
                                                  Substitute(
                                                      Con.Device.Name & " - " & Con.Name,
                                                      ",",
                                                      "."
                                                  ),
                                                  Substitute(
                                                      If(
                                                          IsBlank(Con.'Connected To'),
                                                          Con.'Connected To (Manual)',
                                                          If(
                                                              And(
                                                                  Con.'Tipo de Conexão' = 'Tipo de Conexão'.Speaker,
                                                                  Con.Direção = 'Direção de Conexão'.Input
                                                              ),
                                                              With(
                                                                  LookUp(
                                                                      ConsCol As ColCon,
                                                                      ColCon.new_deviceioconnectionid = Con.'Device IO Connection'
                                                                  ) As IndexedConInfo,
                                                                  LookUp(
                                                                      'Device IO Connections' As RootCon,
                                                                      RootCon.'Device IO Connection' = IndexedConInfo.local_rootcon,
                                                                      RootCon.Device.Name & " - " & RootCon.Name & " | " & RootCon.Localização
                                                                  )
                                                              ),
                                                              If(
                                                                  And(
                                                                      Con.'Tipo de Conexão' = 'Tipo de Conexão'.Speaker,
                                                                      Con.Direção = 'Direção de Conexão'.Output,
                                                                      Con.'Device IO Connection' in Distinct(
                                                                          ConsCol As ColCon,
                                                                          ColCon.local_rootcon
                                                                      )
                                                                  ),
                                                                  With(
                                                                      {
                                                                          Value: Distinct(
                                                                              Filter(
                                                                                  ConsCol As ColCon,
                                                                                  ColCon.local_rootcon = Con.'Device IO Connection',
                                                                                  ColCon.new_deviceioconnectionid <> Con.'Device IO Connection'
                                                                              )As Nei,
                                                                              Nei.new_deviceioconnectionid
                                                                          )
                                                                      } As NeighborConsIds,
                                                                      Concat(
                                                                          Filter(
                                                                              'Device IO Connections' As Con,
                                                                              Con.'Device IO Connection' in NeighborConsIds.Value
                                                                          ) As Con,
                                                                          Con.Device.Name,
                                                                          "+"
                                                                      )
                                                                  ),
                                                                  Con.'Connected To'.Device.Name & " - " & Con.'Connected To'.Name & " | " & Con.'Connected To'.Localização
                                                              )
                                                          )
                                                      ),
                                                      ",",
                                                      "."
                                                  )
                                              )
                                          )
                                      );
                                      UpdateContext({SpinCounter: SpinCounter - 1})
                                    Width: =Self.Height
                        - ConnectionContainer:
                            Control: GroupContainer@1.4.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutMaxHeight: =
                              LayoutMaxWidth: =
                              LayoutMinHeight: =0
                              LayoutMinWidth: =0
                            Children:
                              - ConnectionPicker:
                                  Control: CodeComponent
                                  ComponentName: cat_PowerCAT.Picker
                                  Properties:
                                    FillPortions: =1
                                    Height: =34
                                    HintText: ="Pesquisar Conexões"
                                    Items: |-
                                      =Filter(
                                          'Device IO Connections' As C,
                                          C.'Device IO Connection' = ThisItem.'Connected To'.'Device IO Connection',
                                          C.Device.Projeto.Projeto = CurrentProjeto.Projeto
                                      )
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    MaxTags: =1
                                    MinimumSearchTermLength: =0
                                    NoSuggestionFoundMessage: ="Nenhum sugestão encontrada"
                                    OnChange: |-
                                      =UpdateContext({SpinCounter: SpinCounter + 1});
                                      Switch(
                                          Self.TagEvent,
                                          "Add",
                                          If(
                                              !IsBlank(Self.TagKey),
                                              With(
                                                  LookUp(
                                                      'Device IO Connections' As C,
                                                      C.'Device IO Connection' = GUID(Self.TagKey)
                                                  ) As Target,
                                                  Patch(
                                                      'Device IO Connections',
                                                      {
                                                          'Device IO Connection': ThisItem.'Device IO Connection',
                                                          'Connected To': Target,
                                                          Projeto: LookUp(
                                                              Projetos As P,
                                                              P.Projeto = CurrentProjeto.Projeto
                                                          )
                                                      }
                                                  );
                                                  Patch(
                                                      'Device IO Connections',
                                                      {
                                                          'Device IO Connection': Target.'Device IO Connection',
                                                          'Connected To': LookUp(
                                                              'Device IO Connections' As C,
                                                              C.'Device IO Connection' = ThisItem.'Device IO Connection'
                                                          ),
                                                          Projeto: LookUp(
                                                              Projetos As P,
                                                              P.Projeto = CurrentProjeto.Projeto
                                                          )
                                                      }
                                                  )
                                              )
                                          ),
                                          "Remove",
                                          With(
                                              LookUp(
                                                  'Device IO Connections' As C,
                                                  C.'Device IO Connection' = ThisItem.'Device IO Connection'
                                              ) As SelectedConnectionForEdit,
                                              If(
                                                  SelectedConnectionForEdit.Direção in [
                                                      'Direção de Conexão'.Input,
                                                      'Direção de Conexão'.Output,
                                                      'Direção de Conexão'.Bidirectional
                                                  ],
                                                  Unrelate(
                                                      LookUp(
                                                          'Device IO Connections' As C,
                                                          C.'Device IO Connection' = SelectedConnectionForEdit.'Connected To'.'Device IO Connection'
                                                      ).'Device IO Connections (new_new_deviceioconnection_ConnectedTo_new_de)',
                                                      LookUp(
                                                          'Device IO Connections' As C,
                                                          C.'Device IO Connection' = SelectedConnectionForEdit.'Connected To'.'Device IO Connection'
                                                      )
                                                  )
                                              );
                                              Unrelate(
                                                  LookUp(
                                                      'Device IO Connections' As C,
                                                      C.'Device IO Connection' = SelectedConnectionForEdit.'Device IO Connection'
                                                  ).'Device IO Connections (new_new_deviceioconnection_ConnectedTo_new_de)',
                                                  LookUp(
                                                      'Device IO Connections' As C,
                                                      C.'Device IO Connection' = SelectedConnectionForEdit.'Device IO Connection'
                                                  )
                                              )
                                          )
                                      );
                                      UpdateContext({SpinCounter: SpinCounter - 1})
                                    OnSelect: =
                                    SearchTermToShortMessage: ="Continue Digitando..."
                                    SuggestionsDisplayName: ="new_displayname"
                                    SuggestionsKey: ="new_deviceioconnectionid"
                                    SuggestionsSubDisplayName: ="new_localizacao"
                                    Suggestions_Items: |-
                                      =Search(
                                          Filter(
                                              'Device IO Connections' As C,
                                              C.Device.Projeto.Projeto = CurrentProjeto.Projeto,
                                              C.Device.DeviceIO <> SelectedDevice.DeviceIO,
                                              !IsBlank(C.Device),
                                              C.'Tipo de Conexão' = ThisItem.'Tipo de Conexão',
                                              Or(
                                                  And(
                                                      C.Direção <> 'Direção de Conexão'.Input,
                                                      C.Direção <> 'Direção de Conexão'.Output
                                                  ),
                                                  C.Direção <> ThisItem.Direção
                                              ),
                                              Or(
                                                  IsBlank(C.'Connected To'),
                                                  C.Direção = 'Direção de Conexão'.Bus
                                              )
                                          ),
                                          Self.SearchTerm,
                                          'Display Name',
                                          Name,
                                          Localização
                                      )
                                    TagMaxWidth: =Self.Width-10
                                    TagsDisplayName: ="new_displayname"
                                    TagsKey: ="new_deviceioconnectionid"
                                    Theme: =AppThemeJson
                                    Tooltip: ="Seletor de conexões"
                                    Visible: =Len(Trim(ManualConnectionTextInput.Value)) = 0
                                  Children:
                                    - Display Name1:
                                        Control: DataField@1.5.0
                                        Variant: textualColumn
                                        IsLocked: true
                                        Properties:
                                          FieldDisplayName: ="Display Name"
                                          FieldName: ="new_displayname"
                                          FieldType: ="s"
                                          Order: =1
                                    - Localização1:
                                        Control: DataField@1.5.0
                                        Variant: textualColumn
                                        IsLocked: true
                                        Properties:
                                          FieldDisplayName: ="Localização"
                                          FieldName: ="new_localizacao"
                                          FieldType: ="s"
                                          Order: =2
                              - ConnectionLabel:
                                  Control: FluentV8/Label@1.8.6
                                  Properties:
                                    Alignment: =Align.Center
                                    AutoHeight: =true
                                    FillPortions: =0.1
                                    Height: =0
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinWidth: |
                                      =30
                                    Text: ="ou"
                                    Visible: |-
                                      =And(
                                          ConnectionPicker.Visible,
                                          ManualConnectionTextInput.Visible
                                      )
                              - ManualConnectionTextInput:
                                  Control: TextInput@0.0.54
                                  Properties:
                                    FillPortions: =1
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinWidth: =0
                                    OnChange: |-
                                      =Patch(
                                          'Device IO Connections',
                                          {
                                              'Device IO Connection': ThisItem.'Device IO Connection',
                                              'Connected To (Manual)': Self.Value,
                                                                  Projeto: LookUp(
                                                                      Projetos As P,
                                                                      P.Projeto = CurrentProjeto.Projeto
                                                                  )
                                          }
                                      )
                                    Placeholder: ="Escrever manualmente"
                                    Value: =ThisItem.'Connected To (Manual)'
                                    Visible: |-
                                      =IsBlank(ThisItem.'Connected To'.'Device IO Connection')
                                      /*CountRows(
                                          Filter(
                                              'Device IO Connections' As C,
                                              C.'Device IO Connection' = ThisItem.'Connected To'.'Device IO Connection',
                                              C.Device.Projeto.Projeto = CurrentProjeto.Projeto
                                          )
                                      ) = 0*/
            - RemoveDeviceButton:
                Control: FluentV8/Button@1.5.13
                Properties:
                  BorderRadius: =10
                  FillColor: =RGBA(200,50,50,1)
                  FontWeight: =FontWeight.Semibold
                  Height: =40
                  HoverFillColor: =ColorFade(RGBA(200,50,50,1),20%)
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  LayoutMinWidth: =0
                  OnSelect: |-
                    =UpdateContext({SpinCounter: SpinCounter + 1});
                    With(
                        {
                            Value: Filter(
                                'Device IO Connections' As C,
                                C.Device.DeviceIO = SelectedDevice.DeviceIO
                            )
                        } As Cons,
                        ForAll(
                            Filter(
                                Cons.Value As Con,
                                !IsBlank(Con.'Connected To')
                            ) As Con,
                            If(
                                Con.Direção in [
                                    'Direção de Conexão'.Input,
                                    'Direção de Conexão'.Output,
                                    'Direção de Conexão'.Bidirectional
                                ],
                                Unrelate(
                                    LookUp(
                                        'Device IO Connections' As C,
                                        C.'Device IO Connection' = Con.'Connected To'.'Device IO Connection'
                                    ).'Device IO Connections (new_new_deviceioconnection_ConnectedTo_new_de)',
                                    LookUp(
                                        'Device IO Connections' As C,
                                        C.'Device IO Connection' = Con.'Connected To'.'Device IO Connection'
                                    )
                                )
                            );
                            Unrelate(
                                LookUp(
                                    'Device IO Connections' As C,
                                    C.'Device IO Connection' = Con.'Device IO Connection'
                                ).'Device IO Connections (new_new_deviceioconnection_ConnectedTo_new_de)',
                                LookUp(
                                    'Device IO Connections' As C,
                                    C.'Device IO Connection' = Con.'Device IO Connection'
                                )
                            )
                        );
                        Remove(
                            'Device IO Connections',
                            Filter(
                                'Device IO Connections' As Con,
                                Con.Device.DeviceIO = SelectedDevice.DeviceIO,
                                !IsBlank(Con.Device)
                            )
                        );
                        Remove(
                            'Device IO Connections',
                            Filter(
                                'Device IO Connections' As Con,
                                Con.Device.DeviceIO = SelectedDevice.DeviceIO,
                                !IsBlank(Con.Device)
                            )
                        );
                        Remove(
                            'Device IO',
                            Filter(
                                'Device IO' As D,
                                D.DeviceIO = SelectedDevice.DeviceIO
                            )
                        );
                        Back()
                    );
                    UpdateContext({SpinCounter: SpinCounter - 1})
                  PressedFillColor: =ColorFade(RGBA(200,50,50,1),20%)
                  Text: ="Apagar Dispositivo"
                  Visible: =SettingsSelected = true
      - Spinner2:
          Control: CodeComponent
          ComponentName: cat_PowerCAT.Spinner
          Properties:
            BackgroundColor: ="#00000050"
            Height: =Parent.Height
            Label: ="Carregando..."
            SpinnerSize: ='PowerCAT.Spinner.SpinnerSize'.Large
            Theme: =AppThemeJson
            Visible: =SpinCounter > 0
            Width: =Parent.Width
            X: =0.00
            Y: =0.00
