# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Home Screen:
    Properties:
      Fill: =RGBA(255, 255, 255, 1)
      LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
      OnVisible: |-
        =If(
            IsBlank(SpinCounter),
            UpdateContext({SpinCounter: 0});
            Reset(ProjetoComboboxCanvas);
            Reset(OSComboboxCanvas)
        );
        Select(RefreshButton)
    Children:
      - RootLayoutContainer_HS:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Fill: =RGBA(250, 250, 250, 1)
            Height: =App.Height
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutOverflowY: =LayoutOverflow.Scroll
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =App.Width
          Children:
            - CommandContainer_HS:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =44
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - CommandBar1:
                      Control: CodeComponent
                      ComponentName: cat_PowerCAT.CommandBar
                      Properties:
                        FillPortions: =1
                        Items: |-
                          =Table(
                              {
                                  ItemKey: "Back",
                                  ItemIconName: "Back",
                                  ItemDisplayName: "Voltar"
                              },{
                                  ItemKey: "Refresh",
                                  ItemIconName: "Refresh",
                                  ItemDisplayName: "Atualizar"
                              }
                          )
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        OnSelect: |-
                          =Switch(
                              Self.Selected.ItemKey,
                              "Back",
                              Back(),
                              Select(RefreshButton)
                          )
                        Theme: =AppThemeJson
                        Width: '=600 '
                  - TextCanvas1:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        Text: ="V0.37"
                        VerticalAlign: =VerticalAlign.Middle
                  - RefreshButton:
                      Control: Button@0.0.45
                      Properties:
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        OnSelect: |-
                          =UpdateContext({SpinCounter: SpinCounter + 1});
                          Concurrent(
                              Refresh('Estoque-RMAS'),
                              Refresh(AppPreferences),
                              Refresh('Produtos-Serviço'),
                              Refresh(Projetos)
                          );
                          UpdateContext({SpinCounter: SpinCounter - 1})
                        Visible: =false
                  - ButtonCanvas2:
                      Control: Button@0.0.45
                      Properties:
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        OnSelect: |-
                          =Concurrent(
                                  Refresh(AppPreferences),
                                  Refresh(Users),
                                  Refresh('Estoque-RMAS'),
                                  Refresh(RMAS),
                                  Refresh('Estoque From SharepointLists'),
                                  Refresh('Produtos-Serviço'),
                                  Refresh(Projetos),
                                  Refresh('Ordens de Serviço Field Control'),
                                  Refresh('Atividades Field Control'),
                                  Reset(ProjetoComboboxCanvas),
                                  Reset(OSComboboxCanvas)
                              )
                        Visible: =false
            - SubheaderContainer_HS:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =70
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  PaddingLeft: =10
                  PaddingRight: =10
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - lbTitleCodeReview:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(20, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.Lato
                        FontWeight: =FontWeight.Semibold
                        Height: =70
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        PaddingLeft: =20
                        Size: =14
                        Text: ="Cadastro de Retorno de Mercadoria | " & First(ProjetoSelecionado).Apelido
                        Width: =240
                        Y: =241
            - ContentContainer_HS:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - BodyContainer:
                      Control: GroupContainer@1.4.0
                      Variant: AutoLayout
                      Properties:
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =10
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        PaddingBottom: =10
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =10
                      Children:
                        - MercadoriasContainer:
                            Control: GroupContainer@1.4.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =RGBA(255, 255, 255, 1)
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =10
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutMinHeight: =16
                              LayoutMinWidth: =16
                              PaddingBottom: =8
                              PaddingLeft: =8
                              PaddingRight: =8
                              PaddingTop: =8
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                            Children:
                              - RMAInfoHeaderText:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Center
                                    Font: =Font.Lato
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    Text: ="Informações do RMA"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Bold
                              - FormRowContainer_2:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                  Children:
                                    - FormRowLabelText_2:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Projeto"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =120
                                    - ProjetoComboboxCanvas:
                                        Control: ComboBox@0.0.51
                                        Properties:
                                          DefaultSelectedItems: =[LookUp(Projetos As P,P.Projeto = RMASelecionado.Projeto.Projeto)]//ProjetoSelecionado
                                          FillPortions: =1
                                          InputTextPlaceholder: ="Buscar projetos"
                                          Items: |-
                                            =Search(
                                                Projetos,
                                                Self.SearchText,
                                                Apelido
                                            )
                                          LayoutMaxHeight: =32
                                          LayoutMinWidth: =16
                                          OnChange: |-
                                            =Patch(
                                                RMAS,
                                                LookUp(// registro que será atualizado
                                                    RMAS,
                                                    RMA = RMAId// condição pra achar o RMA certo
                                                ),
                                                {
                                                    Projeto: LookUp(
                                                        Projetos As P,
                                                        P.Projeto = Self.Selected.Projeto
                                                    )// ou Self.Selected se estiver no próprio ComboBox
                                                }
                                            );
                                            ClearCollect(
                                                ProjetoSelecionado,
                                                If(
                                                    !IsBlank(RMASelecionado.Projeto),
                                                    LookUp(
                                                        Projetos As P,
                                                        P.Projeto = RMASelecionado.Projeto.Projeto
                                                    )
                                                )
                                            );
                                            Reset(OSComboboxCanvas)
                                          TriggerOutput: ='ComboboxCanvas.TriggerOutput'.Keypress
                                        Children:
                                          - Apelido1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="Apelido"
                                                FieldName: ="cr22f_apelido"
                                                FieldType: ="s"
                                                Order: =1
                                          - Ano1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="Ano"
                                                FieldName: ="cr22f_ano"
                                                FieldType: ="s"
                                                Order: =2
                              - FormRowContainer_4:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                  Children:
                                    - FormRowLabelText_4:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="OS"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =120
                                    - OSComboboxCanvas:
                                        Control: ComboBox@0.0.51
                                        Properties:
                                          DefaultSelectedItems: |-
                                            =[
                                                LookUp(
                                                    'Ordens de Serviço Field Control' As OS,
                                                    OS.'Ordem de Serviço Field Control' = RMASelecionado.'Ordem de Serviço'.'Ordem de Serviço Field Control'
                                                )
                                            ]//OSSelecionada
                                          FillPortions: =1
                                          InputTextPlaceholder: ="Buscar OS"
                                          Items: |-
                                            =AddColumns(
                                                Search(
                                                    Filter(
                                                        'Ordens de Serviço Field Control' As OS,
                                                        !IsBlank(OS.Projeto),
                                                        OS.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto
                                                    ),
                                                    Self.SearchText,
                                                    Name,
                                                    'Nome do Cliente (Fx)'
                                                ) As OS,
                                                _Label,
                                                OS.Name & " - " & First(
                                                    SortByColumns(
                                                        Filter(
                                                            'Atividades Field Control' As T,
                                                            !IsBlank(T.'Ordem de Serviço Field Control'),
                                                            T.'Ordem de Serviço'.'Ordem de Serviço Field Control' = OS.'Ordem de Serviço Field Control',
                                                            T.'Status Atividade' = "done"
                                                        ),
                                                        "new_agendamento",
                                                        SortOrder.Descending
                                                    )
                                                ).Agendamento
                                            )
                                          LayoutMaxHeight: =32
                                          LayoutMinWidth: =16
                                          OnChange: |-
                                            =Patch(
                                                RMAS,
                                                LookUp(// registro que será atualizado
                                                    RMAS,
                                                    RMA = RMAId// condição pra achar o RMA certo
                                                ),
                                                {
                                                    'Ordem de Serviço': LookUp(
                                                        'Ordens de Serviço Field Control' As OS,
                                                        OS.'Ordem de Serviço Field Control' = Self.Selected.'Ordem de Serviço Field Control'
                                                    )// ou Self.Selected se estiver no próprio ComboBox
                                                }
                                            );
                                            ClearCollect(
                                                OSSelecionada,
                                                If(
                                                    !IsBlank(RMASelecionado.'Ordem de Serviço'),
                                                    LookUp(
                                                        'Ordens de Serviço Field Control' As OS,
                                                        OS.'Ordem de Serviço Field Control' = RMASelecionado.'Ordem de Serviço'.'Ordem de Serviço Field Control'
                                                    )
                                                )
                                            )
                                          TriggerOutput: ='ComboboxCanvas.TriggerOutput'.Keypress
                                        Children:
                                          - _Label2:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="_Label"
                                                FieldName: ="_Label"
                                                FieldType: ="s"
                                                Order: =1
                              - FormRowContainer_7:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                  Children:
                                    - FormRowLabelText_7:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Situação"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =120
                                    - SituacaoComboboxCanvas:
                                        Control: ComboBox@0.0.51
                                        Properties:
                                          DefaultSelectedItems: =[RMASelecionado.Situação]
                                          FillPortions: =1
                                          InputTextPlaceholder: ="Escolha a situação"
                                          Items: =Choices('RMA Stage')
                                          LayoutMaxHeight: =32
                                          LayoutMinWidth: =16
                                          OnChange: |-
                                            =Patch(
                                                RMAS,
                                                LookUp(// registro que será atualizado
                                                    RMAS,
                                                    RMA = RMAId// condição pra achar o RMA certo
                                                ),
                                                {
                                                    Situação: Self.Selected.Value
                                                }
                                            )
                                          TriggerOutput: ='ComboboxCanvas.TriggerOutput'.Keypress
                                        Children:
                                          - Value1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="Value"
                                                FieldName: ="Value"
                                                FieldType: ="l"
                                                Order: =1
                              - FormRowContainer_8:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =100
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                  Children:
                                    - FormRowLabelText_8:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Observações"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =120
                                    - TextInputCanvas1:
                                        Control: TextInput@0.0.54
                                        Properties:
                                          FillPortions: =1
                                          LayoutMinHeight: =16
                                          LayoutMinWidth: =16
                                          OnChange: |-
                                            =Patch(
                                                RMAS,{RMA:RMASelecionado.RMA,Observações:Self.Value}
                                            )
                                          Value: =RMASelecionado.Observações
                              - MercadoriasHeaderText:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Center
                                    Font: =Font.Lato
                                    Height: =24
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    Text: ="Mercadorias Devolvidas"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Bold
                              - MercadoriasCommandBar:
                                  Control: CodeComponent
                                  ComponentName: cat_PowerCAT.CommandBar
                                  Properties:
                                    Height: =32
                                    Items: |-
                                      =Table(
                                          {
                                              ItemKey: "New",
                                              ItemIconName: "Add",
                                              ItemDisplayName: "Nova Mercadoria"
                                          }
                                      )
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    OnSelect: |-
                                      =Switch(
                                          Self.Selected.ItemKey,
                                          "New",
                                          Set(
                                              NovoCadastro,
                                              true
                                          )
                                      )
                                    Theme: =AppThemeJson
                                    Width: '=600 '
                              - MercadoriasTable:
                                  Control: Table@1.0.278
                                  Properties:
                                    FillPortions: =1
                                    Items: |-
                                      =SortByColumns(
                                          Filter(
                                              'Estoque-RMAS' As ER,
                                              !IsBlank(ER.RMA),
                                              ER.RMA.RMA = RMAId
                                          ),
                                          "createdon",
                                          SortOrder.Descending
                                      )
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    OnSelect: |-
                                      =Set(
                                          NovoCadastro,
                                          false
                                      );
                                      Set(
                                          EstoqueRMASelecionadoId,
                                          Self.Selected.RMA
                                      )
                                  Children:
                                    - Etiqueta Produto Antigo1:
                                        Control: TableDataField@1.5.0
                                        Variant: textualColumn
                                        IsLocked: true
                                        Properties:
                                          FieldDisplayName: ="Etiqueta Produto Antigo"
                                          FieldName: ="new_etiquetaprodutoantigo"
                                          FieldType: ="s"
                                          Order: =1
                                    - Etiqueta Produto Novo1:
                                        Control: TableDataField@1.5.0
                                        Variant: textualColumn
                                        IsLocked: true
                                        Properties:
                                          FieldDisplayName: ="Etiqueta Produto Novo"
                                          FieldName: ="new_etiquetaprodutonovo"
                                          FieldType: ="s"
                                          Order: =2
                                    - Tipo de RMA1:
                                        Control: TableDataField@1.5.0
                                        Variant: textualColumn
                                        IsLocked: true
                                        Properties:
                                          FieldDisplayName: ="Tipo de RMA"
                                          FieldName: ="new_tipoderma"
                                          FieldType: ="l"
                                          Order: =3
                                    - Referência do Produto1:
                                        Control: TableDataField@1.5.0
                                        Variant: textualColumn
                                        IsLocked: true
                                        Properties:
                                          FieldDisplayName: ="Referência do Produto"
                                          FieldName: ="new_referenciadoproduto"
                                          FieldType: ="s"
                                          Order: =5
                                    - Created On1:
                                        Control: TableDataField@1.5.0
                                        Variant: textualColumn
                                        IsLocked: true
                                        Properties:
                                          FieldDisplayName: ="Created On"
                                          FieldName: ="createdon"
                                          FieldType: ="d"
                                          Order: =5
                        - MercadoriasContainer_1:
                            Control: GroupContainer@1.4.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =RGBA(255, 255, 255, 1)
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =10
                              LayoutMinHeight: =16
                              LayoutMinWidth: =16
                              PaddingBottom: =8
                              PaddingLeft: =8
                              PaddingRight: =8
                              PaddingTop: =8
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Visible: =ShowMercadoriaInfo
                            Children:
                              - DetalhesMercadoriaHeaderText:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Center
                                    Font: =Font.Lato
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    Text: ="Detalhes da Mercadoria"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Bold
                              - FormRowContainer:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                  Children:
                                    - FormRowLabelText:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Tipo Devolução"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =200
                                    - TipoDevolucaoDropdown:
                                        Control: DropDown@0.0.45
                                        Properties:
                                          AlignInContainer: =AlignInContainer.End
                                          DefaultSelectedItems: =[]
                                          DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                                          FillPortions: =1
                                          Items: =Choices('Tipo de RMA')
                                          LayoutMinHeight: =16
                                          LayoutMinWidth: =16
                                          OnChange: =Reset(ProdutoAntigoCombobox)
                              - FormRowContainer_1:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                    Visible: |-
                                      =TipoDevolucaoDropdown.Selected.Value in [
                                          'Tipo de RMA'.'Devolução de Empréstimo',
                                          'Tipo de RMA'.'Devolução Definitiva do Produto',
                                          'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                          'Tipo de RMA'.'Retorno Para Troca de Produto'
                                      ]
                                  Children:
                                    - FormRowLabelText_1:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Produto Antigo"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =200
                                    - ProdutoAntigoCombobox:
                                        Control: ComboBox@0.0.51
                                        Properties:
                                          DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                                          FillPortions: =1
                                          InputTextPlaceholder: ="Buscar mercadorias"
                                          Items: |-
                                            =AddColumns(
                                                Switch(
                                                    TipoDevolucaoDropdown.Selected.Value,
                                                    'Tipo de RMA'.'Devolução de Empréstimo',
                                                    Search(
                                                        Filter(
                                                            'Estoque From SharepointLists' As E,
                                                            !IsBlank(E.'Produto-Serviço'),
                                                            E.'Produto-Serviço'.'É Empréstimo' = 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                            E.'Produto-Serviço'.'Empréstimo Devolvido' <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                            E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                            Or(
                                                                E.Situação = "Entregue",
                                                                E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                            )
                                                        ),
                                                        Self.SearchText,
                                                        'Referência do Produto',
                                                        'Etiqueta Em Texto (Calculated)'
                                                    ),
                                                    'Tipo de RMA'.Manutenção,
                                                    Search(
                                                        Filter(
                                                            'Estoque From SharepointLists' As E,
                                                            !IsBlank(E.'Produto-Serviço'),
                                                            E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                            E.'Produto-Serviço'.'Empréstimo Devolvido' <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                            E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                            Or(
                                                                E.Situação = "Entregue",
                                                                E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                            ),
                                                            E.Quantidade = 1
                                                        ),
                                                        Self.SearchText,
                                                        'Referência do Produto',
                                                        'Etiqueta Em Texto (Calculated)'
                                                    ),
                                                    'Tipo de RMA'.'Devolução Definitiva do Produto',
                                                    Search(
                                                        Filter(
                                                            'Estoque From SharepointLists' As E,
                                                            !IsBlank(E.'Produto-Serviço'),
                                                            E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                            E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                            E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                            Or(
                                                                E.Situação = "Entregue",
                                                                E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                            ),
                                                            E.'Quantidade Disponível Devolução' > 0
                                                        ),
                                                        Self.SearchText,
                                                        'Referência do Produto',
                                                        'Etiqueta Em Texto (Calculated)'
                                                    ),
                                                    'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                                    Search(
                                                        Filter(
                                                            'Estoque From SharepointLists' As E,
                                                            !IsBlank(E.'Produto-Serviço'),
                                                            E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                            E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                            E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                            Or(
                                                                E.Situação = "Entregue",
                                                                E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                            ),
                                                            E.Quantidade = 1
                                                        ),
                                                        Self.SearchText,
                                                        'Referência do Produto',
                                                        'Etiqueta Em Texto (Calculated)'
                                                    ),
                                                    'Tipo de RMA'.'Retorno Para Troca de Produto',
                                                    Search(
                                                        Filter(
                                                            'Estoque From SharepointLists' As E,
                                                            !IsBlank(E.'Produto-Serviço'),
                                                            E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                            E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                            E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                            Or(
                                                                E.Situação = "Entregue",
                                                                E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                            ),
                                                            E.Quantidade = 1
                                                        ),
                                                        Self.SearchText,
                                                        'Referência do Produto',
                                                        'Etiqueta Em Texto (Calculated)'
                                                    )
                                                ) As E,
                                                _Label,
                                                E.'Etiqueta Em Texto (Calculated)' & " - " & E.'Referência do Produto'
                                            )
                                          LayoutMaxHeight: =32
                                          LayoutMinWidth: =16
                                          OnChange: |-
                                            =Set(
                                                _SN,
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = Self.Selected.'Estoque From SharepointList',
                                                    E.'Número de Série'
                                                )
                                            )
                                        Children:
                                          - new_etiquetaemtextocalculated1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_etiquetaemtextocalculated"
                                                FieldName: ="new_etiquetaemtextocalculated"
                                                FieldType: ="s"
                                                Order: =3
                                          - _Label1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="_Label"
                                                FieldName: ="_Label"
                                                FieldType: ="s"
                                                Order: =2
                                          - new_referenciadoproduto1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_referenciadoproduto"
                                                FieldName: ="new_referenciadoproduto"
                                                FieldType: ="s"
                                                Order: =3
                              - FormRowContainer_9:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                    Visible: |-
                                      =TipoDevolucaoDropdown.Selected.Value in [
                                          'Tipo de RMA'.'Devolução de Empréstimo',
                                          'Tipo de RMA'.'Devolução Definitiva do Produto',
                                          'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                          'Tipo de RMA'.'Retorno Para Troca de Produto'
                                      ]
                                  Children:
                                    - FormRowLabelText_9:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Quantidade Devolvida"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =200
                                    - NumberInput1:
                                        Control: NumberInput@2.9.12
                                        Properties:
                                          FillPortions: =1
                                          LayoutMinHeight: =16
                                          LayoutMinWidth: =16
                                          Max: |-
                                            =LookUp(
                                                'Estoque From SharepointLists' As E,
                                                E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                E.'Quantidade Disponível Devolução'
                                            )
                                          Min: =1
                                          Value: |-
                                            =LookUp(
                                                'Estoque From SharepointLists' As E,
                                                E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                E.'Quantidade Disponível Devolução'
                                            )
                              - FormRowContainer_6:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                    Visible: |-
                                      =Or(
                                          TipoDevolucaoDropdown.Selected.Value in ['Tipo de RMA'.Manutenção,'Tipo de RMA'.'Devolução Definitiva do Produto']
                                      )
                                  Children:
                                    - FormRowLabelText_6:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Produto Novo"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =200
                                    - ProdutoNovoCombobox:
                                        Control: ComboBox@0.0.51
                                        Properties:
                                          DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                                          FillPortions: =1
                                          InputTextPlaceholder: ="Buscar mercadorias"
                                          Items: |-
                                            =AddColumns(
                                                Switch(
                                                    TipoDevolucaoDropdown.Selected.Value,
                                                    'Tipo de RMA'.Manutenção,
                                                    SortByColumns(
                                                        Search(
                                                            Filter(
                                                                'Estoque From SharepointLists' As E,
                                                                IsBlank(E.'Produto-Serviço'),
                                                                E.'Produto-Serviço'.'Empréstimo Devolvido' <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                                E.Situação = "Disponível",
                                                                E.Quantidade = 1
                                                            ),
                                                            Self.SearchText,
                                                            'Referência do Produto',
                                                            'Etiqueta Em Texto (Calculated)'
                                                        ),
                                                        "new_datadaultimaleitura",
                                                        SortOrder.Descending
                                                    ),
                                                    'Tipo de RMA'.'Devolução Definitiva do Produto',
                                                    With(
                                                        {
                                                            EstoqueId: ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                            ModeloId: LookUp(
                                                                'Estoque From SharepointLists' As E,
                                                                E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                                E.'Modelo de Produto'.'Modelos de Produto From Sharepoint List'
                                                            )
                                                        } As Param,
                                                        Search(
                                                            Filter(
                                                                'Estoque From SharepointLists' As E,
                                                                !IsBlank(E.'Produto-Serviço'),
                                                                E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                                E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                                E.Quantidade = NumberInput1.Value,
                                                                E.'Quantidade Disponível Devolução' = NumberInput1.Value,
                                                                E.'Quantidade Disponível Devolução' > 0,
                                                                Or(
                                                                    E.'Estoque From SharepointList' = Param.EstoqueId,
                                                                    And(
                                                                        !IsBlank(E.'Modelo de Produto'),
                                                                        E.'Modelo de Produto'.'Modelos de Produto From Sharepoint List' = Param.ModeloId,
                                                                        E.Situação = "Disponível"
                                                                    )
                                                                )
                                                            ),
                                                            Self.SearchText,
                                                            'Referência do Produto',
                                                            'Etiqueta Em Texto (Calculated)'
                                                        )
                                                    )
                                                ) As E,
                                                _Label,
                                                E.'Etiqueta Em Texto (Calculated)' & " - " & E.'Referência do Produto'
                                            )
                                          LayoutMaxHeight: =32
                                          LayoutMinWidth: =16
                                        Children:
                                          - new_etiquetaemtextocalculated1_1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_etiquetaemtextocalculated"
                                                FieldName: ="new_etiquetaemtextocalculated"
                                                FieldType: ="s"
                                                Order: =3
                                          - _Label1_1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="_Label"
                                                FieldName: ="_Label"
                                                FieldType: ="s"
                                                Order: =2
                                          - new_referenciadoproduto1_1:
                                              Control: ComboBoxDataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_referenciadoproduto"
                                                FieldName: ="new_referenciadoproduto"
                                                FieldType: ="s"
                                                Order: =3
                              - FormRowContainer_3:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                    Visible: |-
                                      =TipoDevolucaoDropdown.Selected.Value in [
                                          'Tipo de RMA'.'Devolução de Empréstimo',
                                          'Tipo de RMA'.'Devolução Definitiva do Produto',
                                          'Tipo de RMA'.'Retorno Para Troca de Produto'
                                      ]
                                  Children:
                                    - FormRowLabelText_3:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =200
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =200
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Aprovar Para Venda"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =200
                                    - AprovarVendaToggle:
                                        Control: Toggle@1.1.5
                                        Properties:
                                          DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                                          FillPortions: =1
                                          Label: =If(Self.Checked = true,"Sim","Não")
                                          LayoutMinHeight: =16
                                          LayoutMinWidth: =16
                              - FormRowContainer_5:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    FillPortions: =0
                                    Height: =48
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =10
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    PaddingBottom: =8
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =8
                                    Visible: |-
                                      =TipoDevolucaoDropdown.Selected.Value in [
                                          'Tipo de RMA'.'Devolução de Empréstimo',
                                          'Tipo de RMA'.Manutenção,
                                          'Tipo de RMA'.'Devolução Definitiva do Produto',
                                          'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                          'Tipo de RMA'.'Retorno Para Troca de Produto'
                                      ]
                                  Children:
                                    - FormRowLabelText_5:
                                        Control: Text@0.0.51
                                        Properties:
                                          Align: ='TextCanvas.Align'.Start
                                          FillPortions: =1
                                          Font: =Font.Lato
                                          LayoutMaxWidth: =190
                                          LayoutMinHeight: =0
                                          LayoutMinWidth: =0
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Text: ="Número de Série"
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =200
                                    - SNTextInput:
                                        Control: TextInput@0.0.54
                                        Properties:
                                          DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                                          FillPortions: =1
                                          Font: =Font.Lato
                                          LayoutMinHeight: =16
                                          LayoutMinWidth: =16
                                          OnChange: =Set(_SN,Self.Value)
                                          Value: =_SN
                              - SaveButton:
                                  Control: Button@0.0.45
                                  Properties:
                                    DisplayMode: |-
                                      =If(
                                          NovoCadastro = true,
                                          Switch(
                                              TipoDevolucaoDropdown.Selected.Value,
                                              'Tipo de RMA'.'Devolução de Empréstimo',
                                              If(
                                                  And(
                                                      !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                                      With(
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                              {
                                                                  Emprestimo: E.'Produto-Serviço'.'É Empréstimo',
                                                                  Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido'
                                                              }
                                                          ) As Prod,
                                                          And(
                                                              Prod.Emprestimo = 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                              Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes
                                                          )
                                                      )
                                                  ),
                                                  DisplayMode.Edit,
                                                  DisplayMode.Disabled
                                              ),
                                              'Tipo de RMA'.Manutenção,
                                              If(
                                                  And(
                                                      !IsBlank(ProdutoNovoCombobox.Selected.'Estoque From SharepointList'),
                                                      With(
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoNovoCombobox.Selected.'Estoque From SharepointList',
                                                              {Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido'}
                                                          ) As Prod,
                                                          Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes
                                                      ),
                                                      !IsBlank(OSComboboxCanvas.Selected.'Ordem de Serviço Field Control'),
                                                      Or(
                                                          Len(TrimEnds(_SN)) > 3,
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoNovoCombobox.Selected.'Estoque From SharepointList',
                                                              E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                          )
                                                      )
                                                  ),
                                                  DisplayMode.Edit,
                                                  DisplayMode.Disabled
                                              ),
                                              'Tipo de RMA'.'Devolução Definitiva do Produto',
                                              If(
                                                  And(
                                                      !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                                      With(
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                              {
                                                                  Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido',
                                                                  Fornecimento: E.'Produto-Serviço'.'Opção de Fornecimento'
                                                              }
                                                          ) As Prod,
                                                          And(
                                                              Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                              Prod.Fornecimento = 'Opção de Fornecimento'.Padrão
                                                          )
                                                      ),
                                                      Or(
                                                          Len(TrimEnds(_SN)) > 3,
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                              E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                          )
                                                      ),
                                                      !IsBlank(ProdutoNovoCombobox.Selected)
                                                  ),
                                                  DisplayMode.Edit,
                                                  DisplayMode.Disabled
                                              ),
                                              'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                              If(
                                                  And(
                                                      !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                                      With(
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                              {
                                                                  Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido',
                                                                  Fornecimento: E.'Produto-Serviço'.'Opção de Fornecimento',
                                                                  Emprestimo: E.'Produto-Serviço'.'É Empréstimo'
                                                              }
                                                          ) As Prod,
                                                          And(
                                                              Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                              Prod.Fornecimento = 'Opção de Fornecimento'.Padrão,
                                                              Prod.Emprestimo <> 'É Empréstimo (Produtos-Serviço)'.Yes
                                                          )
                                                      ),
                                                      Or(
                                                          Len(TrimEnds(_SN)) > 3,
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                              E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                          )
                                                      )
                                                  ),
                                                  DisplayMode.Edit,
                                                  DisplayMode.Disabled
                                              ),
                                              'Tipo de RMA'.'Retorno Para Troca de Produto',
                                              If(
                                                  And(
                                                      !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                                      With(
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                              {
                                                                  Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido',
                                                                  Fornecimento: E.'Produto-Serviço'.'Opção de Fornecimento',
                                                                  Emprestimo: E.'Produto-Serviço'.'É Empréstimo'
                                                              }
                                                          ) As Prod,
                                                          And(
                                                              Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                              Prod.Fornecimento = 'Opção de Fornecimento'.Padrão,
                                                              Prod.Emprestimo <> 'É Empréstimo (Produtos-Serviço)'.Yes
                                                          )
                                                      ),
                                                      Or(
                                                          Len(TrimEnds(_SN)) > 3,
                                                          LookUp(
                                                              'Estoque From SharepointLists' As E,
                                                              E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                              E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                          )
                                                      ),
                                                      AprovarVendaToggle.Checked = true
                                                  ),
                                                  DisplayMode.Edit,
                                                  DisplayMode.Disabled
                                              ),
                                              DisplayMode.Disabled
                                          ),
                                          DisplayMode.View
                                      )
                                    Font: =Font.Lato
                                    LayoutMinHeight: =16
                                    LayoutMinWidth: =16
                                    OnSelect: |-
                                      =UpdateContext({SpinCounter: SpinCounter + 1});
                                      Switch(
                                          TipoDevolucaoDropdown.Selected.Value,
                                          'Tipo de RMA'.'Devolução de Empréstimo',
                                          '(Estoque-RMA)-Registrardevoluçãodeempréstimo'.Run(
                                              ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                              RMASelecionado.RMA,
                                              AprovarVendaToggle.Checked
                                          ),
                                          'Tipo de RMA'.Manutenção,
                                          '(Estoque-RMA)-Registrarretornodeprodutoparamanutenção'.Run(
                                              ProdutoNovoCombobox.Selected.'Estoque From SharepointList',
                                              RMASelecionado.RMA,
                                              OSComboboxCanvas.Selected.'Ordem de Serviço Field Control',
                                              _SN
                                          ),
                                          'Tipo de RMA'.'Devolução Definitiva do Produto',
                                          '(Estoque-RMA)-Registrardevoluçãodefinitivadeprodutovendido'.Run(
                                              ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                              RMASelecionado.RMA,
                                              AprovarVendaToggle.Checked,
                                              _SN,
                                              ProdutoNovoCombobox.Selected.'Estoque From SharepointList'
                                          ),
                                          'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                          '(Estoque-RMA)-Registrarretornotemporáriodeprodutoaoestoque'.Run(
                                              ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                              RMASelecionado.RMA,
                                              _SN
                                          ),
                                          'Tipo de RMA'.'Retorno Para Troca de Produto',
                                          '(Estoque-RMA)-Registrarretornoparatrocadeproduto'.Run(
                                              ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                              RMASelecionado.RMA,
                                              _SN,
                                              AprovarVendaToggle.Checked
                                          ),
                                          false
                                      );
                                      Select(RefreshButton);
                                      Reset(TipoDevolucaoDropdown);
                                      Reset(ProdutoAntigoCombobox);
                                      Reset(AprovarVendaToggle);
                                      Reset(ProdutoNovoCombobox);
                                      Set(
                                          _SN,
                                          Blank()
                                      );
                                      UpdateContext({SpinCounter: SpinCounter - 1})
                                    Text: ="Registrar Retorno"
      - Spinner1:
          Control: CodeComponent
          ComponentName: cat_PowerCAT.Spinner
          Properties:
            BackgroundColor: ="#00000050"
            Height: =Parent.Height
            Label: ="Carregando..."
            SpinnerSize: ='PowerCAT.Spinner.SpinnerSize'.Large
            Theme: =AppThemeJson
            Visible: =SpinCounter > 0
            Width: =Parent.Width
      - ButtonCanvas1:
          Control: Button@0.0.45
          Properties:
            OnSelect: |-
              =Set(
                  RMAId,
                  Last(RMAS).RMA
              );
              Reset(ProjetoComboboxCanvas);
              Reset(OSComboboxCanvas)
            Text: ="TESTE"
            Visible: =false
            X: =564
            Y: =72
