# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Home Screen:
    Properties:
      Fill: =RGBA(255, 255, 255, 1)
      LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
      OnVisible: |-
        =If(
            IsBlank(SpinCounter),
            UpdateContext({SpinCounter: 0})
        )
    Children:
      - RootLayoutContainer_HS:
          Control: GroupContainer@1.4.0
          Variant: AutoLayout
          Properties:
            DropShadow: =DropShadow.None
            Fill: =RGBA(250, 250, 250, 1)
            Height: =App.Height
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutOverflowY: =LayoutOverflow.Scroll
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =App.Width
          Children:
            - CommandContainer_HS:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  AlignInContainer: =AlignInContainer.SetByContainer
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =44
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - CommandBar1:
                      Control: CodeComponent
                      ComponentName: cat_PowerCAT.CommandBar
                      Properties:
                        AlignInContainer: =AlignInContainer.Stretch
                        FillPortions: =1
                        Items: |-
                          =Table(
                              {
                                  ItemKey: "Refresh",
                                  ItemIconName: "Refresh",
                                  ItemDisplayName: "Atualizar"
                              }
                          )
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: =Select(btn_refreshProdutos)
                        Theme: =AppThemeJson
                        Width: '=600 '
                  - CapacityText:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Font: =Font.Lato
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        Text: |-
                          ="Capacidade: " & RoundUp(((CountRows(ProdutosPedido) / 2000) * 100),1) & "%"
                        VerticalAlign: =VerticalAlign.Middle
                        Width: =150
                  - btn_iniciarcotacao:
                      Control: FluentV8/Button@1.5.13
                      Properties:
                        AlignInContainer: =AlignInContainer.Stretch
                        FillPortions: =1
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        OnSelect: |-
                          =UpdateContext({SpinCounter: SpinCounter + 1});
                          With(
                              {
                                  Result: ForAll(
                                      Distinct(
                                          ProdutosSelecionados,
                                          new_produtoservicoid
                                      ),
                                      {Result: ThisRecord.Value}
                                  )
                              } As ProdIds,
                              With(
                                  {
                                      Result: Filter(
                                          'Produtos-Serviço' As P,
                                          P.'Produto-Serviço' in ProdIds.Result && IsBlank(P.Cotação)
                                      )
                                  } As ProdServs,
                                  If(
                                      CountRows(ProdServs.Result) > 0,
                                      With(
                                          {
                                              Result: Patch(
                                                  Cotações,
                                                  Defaults(Cotações),
                                                  {
                                                      Fornecedor: LookUp(
                                                          'Fornecedores From Sharepoint Lists' As F,
                                                          F.ID = FornecedorSelecionadoId
                                                      )
                                                  }
                                              ).Cotação
                                          } As NovaCotacaoId,
                                          If(
                                              !IsBlank(NovaCotacaoId),
                                              With(
                                                  {
                                                      NovaCotacao: LookUp(
                                                          Cotações,
                                                          Cotação = NovaCotacaoId.Result
                                                      ),
                                                      Fornecedor: LookUp(
                                                          'Fornecedores From Sharepoint Lists' As F,
                                                          F.ID = FornecedorSelecionadoId
                                                      )
                                                  } As Results,
                                                  /*Relate(
                                                      Results.Fornecedor.Cotações,
                                                      Results.NovaCotacao
                                                  );*/
                                                  ForAll(
                                                      ProdServs.Result As ProdServ,
                                                      /*Relate(
                                                          Results.NovaCotacao.'Produtos-Serviço',
                                                          ProdServ
                                                      )*/
                                                      Patch(
                                                          'Produtos-Serviço',
                                                          {
                                                              'Produto-Serviço': ProdServ.'Produto-Serviço',
                                                              Cotação: Results.NovaCotacao
                                                          }
                                                      )
                                                  );
                                                  Patch(
                                                      Cotações,
                                                      Results.NovaCotacao,
                                                      {
                                                          'Valor Total': With(
                                                              {
                                                                  Result: Filter(
                                                                      'Produtos-Serviço',
                                                                      Cotação.Cotação = NovaCotacaoId.Result
                                                                  )
                                                              } As ProdServRelacionados,
                                                              Sum(
                                                                  ProdServRelacionados.Result As Cur,
                                                                  Cur.Quantidade * LookUp(
                                                                      'Preços de Produtos',
                                                                      Status = 'Status (Preços de Produtos)'.Active && 'Modelo de Produto'.'Modelos de Produto From Sharepoint List' = Cur.Produto.'Modelos de Produto From Sharepoint List'
                                                                  ).'Preço de Compra'
                                                              )
                                                          )
                                                      }
                                                  );
                                                  Select(btn_refreshProdutos);
                                                  Clear(IdsSelecionados);
                                                  Launch(
                                                      "https://unium.crm2.dynamics.com/main.aspx?appid=3ec4d8a9-2a8e-ee11-8179-002248de6f66&forceUCI=1&pagetype=entityrecord&etn=new_cotacao&id=" & NovaCotacaoId.Result,
                                                      Blank(),
                                                      LaunchTarget.New
                                                  )
                                              )
                                          )
                                      )
                                  )
                              )
                          );
                          UpdateContext({SpinCounter: SpinCounter - 1})
                        Text: ="btn_iniciarcotacao"
                        Visible: =false
                  - btn_refreshProdutos:
                      Control: Button@0.0.45
                      Properties:
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        OnSelect: |-
                          =Concurrent(
                              Refresh('Produtos-Serviço'),
                              Refresh('Modelos de Produto From Sharepoint Lists'),
                              Refresh('Fabricantes From Sharpoint Lists'),
                              Refresh('Preços de Produtos'),
                              Refresh(Cotações),
                              Refresh(AppPreferences),
                              Refresh(Users)
                          );/*
                          ClearCollect(
                              ProdutosFornecedor,
                              AddColumns(
                                  GroupBy(
                                      Filter(
                                          ProdutosPedido As P,
                                          P.new_fornecedorprincipalid = FornecedorSelecionadoId
                                      ),
                                      new_nomedoclientefx,
                                      new_referenciadoproduto,
                                      new_entregaproxima,
                                      new_produtoservicoid,
                                      new_previsaodeentrega,
                                      new_descricao,
                                      new_fornecedorprincipalid,
                                      new_nomedofabricantev2,
                                      Produtos
                                  ) As Prods,
                                  new_quantidade,
                                  Sum(
                                      Prods.Produtos As P,
                                      P.new_quantidade
                                  ),
                                  DataEntrega,
                                  Text(
                                      Prods.new_previsaodeentrega,
                                      DateTimeFormat.ShortDate,
                                      "pt-BR"
                                  ),
                                  Selecionado,
                                  false
                              )
                          )*/
                        Visible: =false
                  - VersionText:
                      Control: Text@0.0.51
                      Properties:
                        Align: ='TextCanvas.Align'.Center
                        Font: =Font.Lato
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        Text: ="V0.17"
                        VerticalAlign: =VerticalAlign.Middle
            - SubheaderContainer_HS:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  FillPortions: =0
                  Height: =70
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  PaddingLeft: =10
                  PaddingRight: =10
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - lbTitleCodeReview:
                      Control: Label@2.5.1
                      Properties:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =RGBA(20, 0, 0, 1)
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        FocusedBorderThickness: =4
                        Font: =Font.Lato
                        FontWeight: =FontWeight.Semibold
                        Height: =70
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        PaddingLeft: =20
                        Size: =14
                        Text: ="Compras"
                        Width: =240
                        Y: =241
                  - SearchBox_1:
                      Control: CanvasComponent
                      ComponentName: SearchBox
                      Properties:
                        Height: =36
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        Styles: |-
                          =Table({Name: "PrimaryColor1Value", Value: "#ffffff"},
                          {Name: "PrimaryColor1TextValue", Value: "#292929"},
                          {Name: "PrimaryColor2Value", Value: "#0078d4"},
                          {Name: "PrimaryColor2TextValue", Value: "#ffffff"},
                          {Name: "PrimaryColor3Value", Value: "#303030"},
                          {Name: "PrimaryColor3TextValue", Value: "#080808"},
                          {Name: "PrimaryColor4Value", Value: "#006e7d"},
                          {Name: "defaultLabelColorValue", Value: "#333333"},
                          {Name: "RadiusValue", Value: "0"},
                          {Name: "TextBodyFontFaceValue", Value: "Segoe UI" },
                          {Name: "PaddingValue", Value: "8"},
                          {Name: "TextEmphasisFontSizeValue", Value: "16"},
                          {Name: "TextEmphasisFontSizePhoneValue", Value: "24"},
                          {Name: "TextBodyFontSizeValue", Value: "12"},
                          {Name: "TextBodyFontSizePhoneValue", Value: "21"},
                          {Name: "BackgroundColorValue", Value: "#ffffff"},
                          {Name: "BorderThicknessValue", Value: "0"},
                          {Name: "BorderColorValue", Value: "#FFFFFF"},
                          {Name: "FocusedBorderThicknessValue", Value: "0"},
                          {Name: "BackgroundColorValue", Value :"#FFFFFF"}
                          )
                        Width: =300
            - ContentContainer_HS:
                Control: GroupContainer@1.4.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.None
                  LayoutAlignItems: =LayoutAlignItems.Stretch
                  LayoutDirection: =LayoutDirection.Vertical
                  LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                  LayoutMaxHeight: =
                  LayoutMaxWidth: =
                  RadiusBottomLeft: =0
                  RadiusBottomRight: =0
                  RadiusTopLeft: =0
                  RadiusTopRight: =0
                Children:
                  - BodyContainer:
                      Control: GroupContainer@1.4.0
                      Variant: AutoLayout
                      Properties:
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =20
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        PaddingBottom: =10
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =10
                      Children:
                        - FirstLaneContainer:
                            Control: GroupContainer@1.4.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =ColorValue(AppTheme.palette.neutralLighter)
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutMaxHeight: =
                              LayoutMaxWidth: =
                              PaddingBottom: =10
                              PaddingLeft: =10
                              PaddingRight: =10
                              PaddingTop: =10
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                            Children:
                              - FornecedoresText:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Center
                                    Font: =Font.Lato
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    Size: =16
                                    Text: ="Fornecedores"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                              - FornecedoresGallery:
                                  Control: Gallery@2.15.0
                                  Variant: BrowseLayout_Vertical_ThreeTextVariant_pcfCore
                                  Properties:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    BorderColor: =RGBA(166, 166, 166, 1)
                                    Fill: =RGBA(255, 255, 255, 0)
                                    FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                    FocusedBorderThickness: =2
                                    Items: |-
                                      =Search(
                                          Fornecedores,
                                          SearchBox_1.SearchText,
                                          NomeFantasia,
                                          RazãoSocial,
                                          ID
                                      )
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    OnSelect: |-
                                      =UpdateContext({SpinCounter: SpinCounter + 1});
                                      If(
                                          FornecedorSelecionadoId <> ThisItem.ID,
                                          Clear(IdsSelecionados)
                                      );
                                      Set(
                                          FornecedorSelecionadoId,
                                          ThisItem.ID
                                      );
                                      Select(btn_refreshProdutos);
                                      UpdateContext({SpinCounter: SpinCounter - 1})
                                    TemplatePadding: =10
                                    TemplateSize: =40
                                  Children:
                                    - FornecedorContainer:
                                        Control: GroupContainer@1.4.0
                                        Variant: AutoLayout
                                        Properties:
                                          BorderColor: =ColorValue(AppTheme.palette.neutralLight)
                                          BorderThickness: =1
                                          Fill: |-
                                            =If(
                                                And(
                                                    ThisItem.ID = FornecedorSelecionadoId,
                                                    !IsBlank(FornecedorSelecionadoId)
                                                ),
                                                ColorValue(AppTheme.palette.neutralLight),
                                                ColorValue(AppTheme.palette.white)
                                            )
                                          Height: =Parent.TemplateHeight
                                          LayoutAlignItems: =LayoutAlignItems.Stretch
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                          PaddingLeft: =10
                                          PaddingRight: =10
                                          Width: =Parent.TemplateWidth
                                        Children:
                                          - FornecedorTitle:
                                              Control: FluentV8/Label@1.8.6
                                              Properties:
                                                Alignment: =Align.Left
                                                AutoHeight: =true
                                                FillPortions: =1
                                                Font: =Font.Lato
                                                FontWeight: =FontWeight.Semibold
                                                Height: =24
                                                LayoutMaxHeight: =
                                                LayoutMaxWidth: =
                                                LayoutMinHeight: =0
                                                LayoutMinWidth: =0
                                                OnSelect: =
                                                TabIndex: =-1
                                                Text: =Coalesce(ThisItem.NomeFantasia,ThisItem.RazãoSocial)
                                                VerticalAlignment: =VerticalAlign.Middle
                                                Width: =
                                                X: =12
                                                Y: =
                                          - FornecedorCounter:
                                              Control: FluentV8/Label@1.8.6
                                              Properties:
                                                Alignment: =Align.Right
                                                AutoHeight: =true
                                                FillPortions: =1
                                                Font: =Font.Lato
                                                FontWeight: =FontWeight.Normal
                                                Height: =24
                                                LayoutMaxHeight: =
                                                LayoutMaxWidth: =
                                                LayoutMinHeight: =0
                                                LayoutMinWidth: =0
                                                OnSelect: =
                                                TabIndex: =-1
                                                Text: =ThisItem.Counter
                                                VerticalAlignment: =VerticalAlign.Middle
                                                Width: =
                                                X: =12
                                                Y: =
                                    - Rectangle2:
                                        Control: Rectangle@2.3.0
                                        Properties:
                                          BorderColor: =RGBA(166, 166, 166, 1)
                                          BorderStyle: =BorderStyle.None
                                          BorderThickness: =2
                                          DisabledFill: =RGBA(166, 166, 166, 0)
                                          Fill: =RGBA(0, 0, 0, 0)
                                          FocusedBorderColor: =RGBA(0, 120, 212, 1)
                                          Height: =Parent.TemplateHeight
                                          HoverFill: =RGBA(0, 120, 212, 0)
                                          OnSelect: =Select(Parent)
                                          PressedFill: =RGBA(0, 120, 212, 0)
                                          Width: =Parent.TemplateWidth
                        - SecondLaneContainer:
                            Control: GroupContainer@1.4.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =ColorValue(AppTheme.palette.neutralLighter)
                              FillPortions: =2
                              LayoutAlignItems: =LayoutAlignItems.Stretch
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutMaxHeight: =
                              LayoutMaxWidth: =
                              PaddingBottom: =10
                              PaddingLeft: =10
                              PaddingRight: =10
                              PaddingTop: =10
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                            Children:
                              - ProdutosText:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Center
                                    Font: =Font.Lato
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    Size: =16
                                    Text: ="Produtos p/ pedido"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Visible: =!IsBlank(FornecedorSelecionadoId)
                                    Weight: ='TextCanvas.Weight'.Semibold
                              - ProdutosContainer:
                                  Control: GroupContainer@1.4.0
                                  Variant: AutoLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutGap: =10
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMaxHeight: =
                                    LayoutMaxWidth: =
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    RadiusBottomLeft: =10
                                    RadiusBottomRight: =10
                                    RadiusTopLeft: =10
                                    RadiusTopRight: =10
                                    Visible: =ProdutosText.Visible
                                  Children:
                                    - CommandBar2:
                                        Control: CodeComponent
                                        ComponentName: cat_PowerCAT.CommandBar
                                        Properties:
                                          Height: =32
                                          Items: |-
                                            =Table(
                                                {
                                                    ItemKey: "Fechar",
                                                    ItemIconName: "Cancel",
                                                    ItemDisplayName: "Fechar",
                                                    ItemVisible: true
                                                },
                                                {
                                                    ItemKey: "SelecionarTudo",
                                                    ItemIconName: "SelectAll",
                                                    ItemDisplayName: "Selecionar Tudo",
                                                    ItemVisible: CountRows(ProdutosSelecionados) <> CountRows(ProdutosFornecedor)
                                                },
                                                {
                                                    ItemKey: "DeselecionarTudo",
                                                    ItemIconName: "ClearSelection",
                                                    ItemDisplayName: "Limpar Seleção",
                                                    ItemVisible: CountRows(ProdutosSelecionados) > 0
                                                },
                                                {
                                                    ItemKey: "Iniciar Cotação",
                                                    ItemIconName: "ShoppingCart",
                                                    ItemDisplayName: "Iniciar Cotação",
                                                    ItemVisible: And(
                                                        CountRows(ProdutosSelecionados) > 0,
                                                        ProdutosDList.Visible
                                                    )
                                                }
                                            )
                                          LayoutMaxHeight: =
                                          LayoutMaxWidth: =
                                          OnSelect: |-
                                            =Switch(
                                                Self.Selected.ItemKey,
                                                "Iniciar Cotação",
                                                Select(btn_iniciarcotacao),
                                                "Fechar",
                                                Concurrent(
                                                    Set(
                                                        FornecedorSelecionadoId,
                                                        Blank()
                                                    ),
                                                    Clear(IdsSelecionados)
                                                ),
                                                "SelecionarTudo",
                                                ClearCollect(
                                                    IdsSelecionados,
                                                    ForAll(
                                                        ProdutosFornecedor As P,
                                                        P.new_produtoservicoid
                                                    )
                                                ),
                                                "DeselecionarTudo",
                                                Clear(IdsSelecionados),
                                                false
                                            )
                                          Theme: =AppThemeJson
                                          X: =40
                                          Y: =40
                                    - ProdutosDList:
                                        Control: CodeComponent
                                        ComponentName: cat_PowerCAT.FluentDetailsList
                                        Properties:
                                          FillPortions: =1
                                          Items: |-
                                            =AddColumns(
                                                ProdutosFornecedor As P,
                                                IconeSelecionado,
                                                If(
                                                    P.Selecionado,
                                                    "icon:SkypeCircleCheck",
                                                    "icon:CircleRing"
                                                ),
                                                TagColor,
                                                If(
                                                    P.Selecionado,
                                                    AppTheme.palette.themePrimary,
                                                    AppTheme.palette.neutralPrimary
                                                ),
                                                PrevisaoEntrega,
                                                Text(
                                                    P.new_previsaodeentrega,
                                                    DateTimeFormat.ShortDate,
                                                    "pt-BR"
                                                )
                                            )
                                          LayoutMaxHeight: =
                                          LayoutMaxWidth: =
                                          OnChange: |-
                                            =Set(
                                                Debug,
                                                Self.EventRowKey
                                            );
                                            If(
                                                And(
                                                    Self.EventName = "CellAction",
                                                    Self.EventColumn = "IconeSelecionado",
                                                    !IsBlank(Self.EventRowKey)
                                                ),
                                                With(
                                                    {Value: GUID(Self.EventRowKey)} As Key,
                                                    If(
                                                        IsBlank(
                                                            LookUp(
                                                                IdsSelecionados As Id,
                                                                Id.Value = Key.Value
                                                            )
                                                        ),
                                                        Collect(
                                                            IdsSelecionados,
                                                            Key
                                                        ),
                                                        Remove(
                                                            IdsSelecionados,
                                                            Key
                                                        )
                                                    )
                                                )
                                            )
                                          OnSelect: =
                                          RecordKey: ="new_produtoservicoid"
                                          RecordSelected: ="Selecionado"
                                          SelectRowsOnFocus: =true
                                          SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                                          columns_Items: |-
                                            =[
                                                {
                                                    ColName: "IconeSelecionado",
                                                    ColDisplayName: "",
                                                    ColCellType: "clickableimage",
                                                    ColWidth: 40,
                                                    ColTagColorColumn: "TagColor",
                                                    ColVerticalAlign: "Center",
                                                    ColHorizontalAlign: "Center",
                                                    ColResizable: true
                                                },
                                                {
                                                    ColDisplayName: "Quant.",
                                                    ColName: "new_quantidade",
                                                    ColWidth: 100
                                                },
                                                {
                                                    ColDisplayName: "Cliente",
                                                    ColName: "new_nomedoclientefx",
                                                    ColWidth: 100
                                                },
                                                {
                                                    ColDisplayName: "Ref",
                                                    ColName: "new_referenciadoproduto",
                                                    ColWidth: 100
                                                },
                                                {
                                                    ColDisplayName: "Descrição",
                                                    ColName: "new_descricao",
                                                    ColWidth: Self.Width - 400 - 140
                                                },
                                                {
                                                    ColDisplayName: "Previsão",
                                                    ColName: "PrevisaoEntrega",
                                                    ColWidth: 100
                                                }
                                            ]
                                        Children:
                                          - new_quantidade2:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_quantidade"
                                                FieldName: ="new_quantidade"
                                                FieldType: ="n"
                                                Order: =1
                                          - new_nomedoclientefx2:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_nomedoclientefx"
                                                FieldName: ="new_nomedoclientefx"
                                                FieldType: ="s"
                                                Order: =2
                                          - new_referenciadoproduto2:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_referenciadoproduto"
                                                FieldName: ="new_referenciadoproduto"
                                                FieldType: ="s"
                                                Order: =3
                                          - new_descricao2:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="new_descricao"
                                                FieldName: ="new_descricao"
                                                FieldType: ="s"
                                                Order: =4
                                          - IconeSelecionado1:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="IconeSelecionado"
                                                FieldName: ="IconeSelecionado"
                                                FieldType: ="s"
                                                Order: =5
                                          - TagColor1:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="TagColor"
                                                FieldName: ="TagColor"
                                                FieldType: ="s"
                                                Order: =6
                                          - PrevisaoEntrega1:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="PrevisaoEntrega"
                                                FieldName: ="PrevisaoEntrega"
                                                FieldType: ="s"
                                                Order: =7
                                          - DataEntrega1:
                                              Control: DataField@1.5.0
                                              Variant: textualColumn
                                              IsLocked: true
                                              Properties:
                                                FieldDisplayName: ="DataEntrega"
                                                FieldName: ="DataEntrega"
                                                FieldType: ="s"
                                                Order: =8
                                    - lbl_produtosParaCompra_ValorTotal:
                                        Control: FluentV8/Label@1.8.6
                                        Properties:
                                          Alignment: =Align.Left
                                          AutoHeight: =true
                                          Color: =RGBA(0, 0, 0, 1)
                                          FontSize: =12
                                          FontWeight: =FontWeight.Semibold
                                          Height: =
                                          LayoutMaxHeight: =
                                          LayoutMaxWidth: =
                                          OnSelect: =
                                          PaddingStart: =10
                                          Text: |-
                                            ="Valor Total: "&With(
                                                            {
                                                                Result: ForAll(Distinct(
                                                                    ProdutosSelecionados As X,
                                                                    X.new_produtoservicoid
                                                                ), {Result: ThisRecord.Value})
                                                            } As SelecaoIds,
                                                            With(
                                                                {
                                                                    Result: Filter(
                                                                        'Produtos-Serviço',
                                                                        'Produto-Serviço' in SelecaoIds.Result
                                                                    )
                                                                } As Selecao,
                                                                Text(
                                                                    Sum(
                                                                        Selecao.Result As Prod,
                                                                        LookUp(
                                                                            'Preços de Produtos' As Prec,
                                                                            Prec.'Modelo de Produto'.'Modelos de Produto From Sharepoint List' = Prod.Produto.'Modelos de Produto From Sharepoint List'
                                                                        ).'Preço de Compra' * Prod.Quantidade
                                                                    ),
                                                                    "[$-pt-BR]R$#.##0,00"
                                                                )
                                                            )
                                                        )
                                          Visible: =CountRows(ProdutosSelecionados) > 0
                                    - SummaryButton:
                                        Control: FluentV8/Button@1.5.13
                                        Properties:
                                          LayoutMaxHeight: =
                                          LayoutMaxWidth: =
                                          OnSelect: |-
                                            =UpdateContext({ShowPrintSummaryWindow: If(ShowPrintSummaryWindow,false,true)})
                                          Text: ="Imprimir Resumo"
                                          Visible: =lbl_produtosParaCompra_ValorTotal.Visible
                                    - PCFCopyTextComponent1:
                                        Control: CodeComponent
                                        ComponentName: tbag_CanvizLLCPCF.PCFCopyTextComponent
                                        Properties:
                                          Height: =40
                                          LayoutMaxHeight: =
                                          LayoutMaxWidth: =
                                          OnChange: |-
                                            =UpdateContext({ShowPrintSummaryWindow: If(ShowPrintSummaryWindow,false,true)})
                                          Value: |-
                                            =Concat(
                                                ForAll(
                                                    SortByColumns(
                                                        GroupBy(
                                                            ProdutosSelecionados,
                                                            new_referenciadoproduto,
                                                            Items
                                                        ),
                                                        "new_referenciadoproduto",
                                                        SortOrder.Ascending
                                                    ) As Group,
                                                    Concatenate(
                                                        Sum(
                                                            Group.Items As I,
                                                            I.new_quantidade
                                                        ),
                                                        "x ",
                                                        Group.new_referenciadoproduto
                                                    )
                                                ) As Cur,
                                                Cur.Value,
                                                Char(13)
                                            )
                                          Visible: =And(ShowPrintSummaryWindow,SummaryButton.Visible)
      - Spinner1:
          Control: CodeComponent
          ComponentName: cat_PowerCAT.Spinner
          Properties:
            BackgroundColor: ="#00000050"
            Height: =Parent.Height
            Label: ="Carregando..."
            SpinnerSize: ='PowerCAT.Spinner.SpinnerSize'.Large
            Theme: =AppThemeJson
            Visible: =Or(SpinCounter > 0, Not(CountRows(Fornecedores) > 0))
            Width: =Parent.Width
