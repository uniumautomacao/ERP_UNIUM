ReportScreen As screen:
    Height: =1123
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =UpdateContext(
            {//LoadTimer: true,
        SpinCounter2: SpinCounter2 + 1}
        );
        ClearCollect(
            SummaryItems,
            With(
                {
                    Value: SortByColumns(
                        AddColumns(
                            InputDevices As Cur,
                            TemplateHeight,
                            29 + 40 + CountRows(Cur.Connections) * 35/*
                            CountIf(
                                Cur.Connections As C,
                                true//Not(Len(C.new_localizacao) > 0)
                            ) * 33 + CountIf(
                                Cur.Connections As I,
                                false//Len(I.new_localizacao) > 0
                            ) * 46 + 80 + 5*/,
                            Position,
                            0,
                            DeviceName,
                            First(Cur.Connections).new_Device.Name,
                            TipoDeSistema,
                            With(
                                {Value: GUID(Cur.new_deviceid)} As Id,
                                LookUp(
                                    DeviceIOs As D,
                                    D.DeviceIO = Id.Value,
                                    D.'Modelo de Produto'.'Tipo de Sistema Padrão'
                                )
                            )
                        ),
                        "new_localizacao",
                        SortOrder.Ascending,
                        "TipoDeSistema",
                        SortOrder.Ascending
                    )
                } As Sections,
                ForAll(
                    Sequence(CountRows(Sections.Value)) As I,
                    Patch(
                        Index(
                            Sections.Value,
                            I.Value
                        ),
                        {
                            IndexValue: I.Value,
                            Page: -1
                        }
                    )
                )
            )
        );
        //Definir páginas
        UpdateIf(
            SummaryItems As S,
            S.new_deviceid = Index(
                SummaryItems,
                1
            ).new_deviceid,
            {Page: 1}
        );
        With(
            {
                Value: Filter(
                    SummaryItems As I,
                    I.Page < 1
                )
            } As Items,
            ForAll(
                Items.Value As Item,
                With(
                    {
                        MaxPage: Max(
                            SummaryItems,
                            Page
                        )
                    } As Para,
                    If(
                        (Sum(
                            Filter(
                                SummaryItems As I,
                                I.Page = Para.MaxPage
                            ),
                            TemplateHeight
                        ) + Item.TemplateHeight) > 890,
                        UpdateIf(
                            SummaryItems As I,
                            I.new_deviceid = Item.new_deviceid,
                            {Page: Para.MaxPage + 1}
                        ),
                        UpdateIf(
                            SummaryItems As I,
                            I.new_deviceid = Item.new_deviceid,
                            {Page: Para.MaxPage}
                        )
                    )
                )
            )
        );
        UpdateContext(
            {
                CurrentPage: 1,
                SpinCounter2: Max(
                    SpinCounter2 - 1,
                    0
                )//,LoadTimer: false
            }
        )
    Width: =794

    SummaryNovoPageContainer As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Height: |
            =Parent.Height-65
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGridColumns: =6
        LayoutGridRows: =6
        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =Parent.Width
        Y: =40
        ZIndex: =1

        SummaryHeaderContainer As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =40
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingRight: =40
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =1

            SummaryHeaderLogo As image:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =Parent.Height
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(0, 0, 0, 0)
                Image: =logo_fundobranco_slogan_medium
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =0
                OnSelect: =Navigate('Home Screen')
                PaddingLeft: =20
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedFill: =RGBA(0, 0, 0, 0)
                Width: |
                    =200
                ZIndex: =1

        SummaryClienteContainer As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =20
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =10
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =7

            SummaryClienteNameLabel As Button:
                Alignment: =Align.Left
                BorderColor: =RGBA(179, 179, 179, 1)
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                ButtonType: ='Button.ButtonType'.Standard
                DisabledBorderColor: =RGBA(204, 204, 204, 1)
                DisabledFillColor: =RGBA(255, 255, 255, 1)
                DisabledTextColor: =RGBA(0, 0, 0, 1)
                DisplayMode: =DisplayMode.View
                FillColor: =
                FillPortions: =1
                Font: =Font.'Lato Black'
                FontSize: =11
                FontWeight: =FontWeight.Normal
                Height: =32
                HoverBorderColor: =
                HoverFillColor: =
                HoverTextColor: =
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnChange: =false
                PressedBorderColor: =
                PressedFillColor: =
                PressedTextColor: =
                Text: ="Guia de Conexões "&CurrentProjeto.Apelido
                TextColor: =
                Width: =96
                X: =0
                Y: =0
                ZIndex: =3

        SummaryGallery As gallery.BrowseLayout_Flexible_SocialFeed_pcfCore:
            '#CopilotOverlayLabel': ="Filtered"
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(166, 166, 166, 1)
            DelayItemLoading: =true
            FocusedBorderColor: =RGBA(0, 120, 212, 1)
            FocusedBorderThickness: =2
            Items: =Filter(SummaryItems As I, I.Page = CurrentPage)
            Layout: =Layout.Vertical
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =287
            LayoutMinWidth: =320
            LoadingSpinner: =LoadingSpinner.Data
            TemplateSize: =317
            X: =60
            Y: =60
            ZIndex: =9

            Image6 As image:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Height: =SummaryGalleryTemplateContainer.Height
                HoverBorderColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(0, 0, 0, 0)
                ImagePosition: =ImagePosition.Fill
                OnSelect: =Select(Parent)
                PressedBorderColor: =RGBA(0, 0, 0, 0)
                PressedFill: =RGBA(0, 0, 0, 0)
                Visible: =false
                Width: =Parent.TemplateWidth
                X: =SummaryGalleryTemplateContainer.X
                Y: =SummaryGalleryTemplateContainer.Y
                ZIndex: =3

            SummaryGalleryTemplateContainer As groupContainer.verticalAutoLayoutContainer:
                Height: =ThisItem.TemplateHeight
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGridColumns: =6
                LayoutGridRows: =6
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Width: =Parent.TemplateWidth
                ZIndex: =5

                SummaryGallerySectionTitleContainer As groupContainer.horizontalAutoLayoutContainer:
                    Fill: =ColorValue(AppTheme.palette.neutralLight)
                    FillPortions: =0
                    Height: =29
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutGridColumns: =6
                    LayoutGridRows: =6
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =5
                    PaddingRight: =5
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    ZIndex: =1

                    SummaryGallerySectionTitle As Label:
                        AcceptsFocus: =false
                        AutoHeight: =false
                        Color: =
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Font: =Font.'Lato Black'
                        FontSize: =10.5
                        FontWeight: =FontWeight.Normal
                        Height: =20
                        Italic: =false
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        OnChange: =false
                        OnSelect: =
                        Strikethrough: =false
                        TabIndex: =-1
                        Text: =ThisItem.DeviceName
                        Underline: =false
                        VerticalAlignment: =VerticalAlign.Top
                        Width: =
                        X: =
                        Y: =
                        ZIndex: =1

                    SummaryGallerySectionAmbienteSubtitle As Label:
                        AcceptsFocus: =false
                        Alignment: =Align.Right
                        AutoHeight: =false
                        Color: =
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Font: =Font.'Lato Black'
                        FontSize: =10.5
                        FontWeight: =FontWeight.Normal
                        Height: =20
                        Italic: =false
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =320
                        OnChange: =false
                        OnSelect: =
                        Strikethrough: =false
                        TabIndex: =-1
                        Text: |-
                            ="Localização: "&ThisItem.new_localizacao
                        Underline: =false
                        VerticalAlignment: =VerticalAlign.Top
                        Visible: =Len(TrimEnds(ThisItem.new_localizacao))>0
                        Width: =
                        X: =
                        Y: =
                        ZIndex: =2

                SummaryGalleryTemplateDListContainer As groupContainer.manualLayoutContainer:
                    BorderColor: =RGBA(153, 153, 153, 1)
                    BorderThickness: =1
                    Height: =//SummaryGalleryTemplateDList.Height
                    LayoutGridColumns: =6
                    LayoutGridRows: =6
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =0
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    ZIndex: =3

                    "SummaryGalleryTemplateDList As 'Fluent Details List (1.1.29)'.pcfdataset":
                        AlternateRowColor: =AppTheme.palette.neutralLighter
                        columns_Items: |-
                            =Table(
                                {
                                    ColName: "new_name",
                                    ColDisplayName: "Porta de Origem",
                                    ColWidth: 130,
                                    ColIsBold: true,
                                    ColVerticalAlign: "Center",
                                    ColHorizontalAlign: "Left"
                                    //,ColShowAsSubTextOf: "Descrição"
                                },
                                {
                                    ColName: "new_tipodeconexao",
                                    ColDisplayName: "Porta",
                                    ColSortable: true,
                                    ColWidth: 90,
                                    ColRowHeader: true,
                                    ColResizable: true,
                                    ColHorizontalAlign: "Left",
                                    ColVerticalAlign: "Center",
                                    ColIsBold: false
                                },
                                {
                                    ColName: "new_direcao",
                                    ColDisplayName: "Direção",
                                    ColSortable: true,
                                    ColWidth: 50,
                                    ColRowHeader: true,
                                    ColResizable: true,
                                    ColHorizontalAlign: "Left",
                                    ColVerticalAlign: "Center",
                                    ColIsBold: false//,ColShowAsSubTextOf: "new_tipodeconexao"
                                },
                                {
                                    ColName: "ConnectedToLocation",
                                    ColDisplayName: "Local Destino",
                                    ColWidth: 100,
                                    ColIsBold: false,
                                    ColVerticalAlign: "Center",
                                    ColHorizontalAlign: "Left"//, ColShowAsSubTextOf: "ConnectedToDeviceName"
                                },
                                {
                                    ColName: "ConnectedToDeviceName",
                                    ColDisplayName: "Dispositivo Destino",
                                    ColSortable: true,
                                    ColWidth: Self.Width - 45 - 45 - 130 - 130 - 65 - 50 - 140,
                                    ColResizable: true,
                                    ColHorizontalAlign: "Left",
                                    ColVerticalAlign: "Center",
                                    ColLabelAbove: false,
                                    ColIsBold: true
                                },
                                {
                                    ColName: "ConnectedToName",
                                    ColDisplayName: "Porta de Destino",
                                    ColSortable: true,
                                    ColWidth: 130,
                                    ColResizable: true,
                                    ColMultiLine: true,
                                    ColHorizontalAlign: "Left",
                                    ColVerticalAlign: "Center",
                                    ColIsBold: true
                                }
                            )
                        Compact: =true
                        CurrentSortColumn: =""
                        CurrentSortDirection: ='PowerCAT.FluentDetailsList.CurrentSortDirection'.Ascending
                        DisplayMode: =DisplayMode.Edit
                        Height: =Parent.Height
                        Items: =ThisItem.Connections
                        SelectionAlwaysVisible: =false
                        SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                        Theme: =AppThemeJson
                        Visible: =false
                        Width: =Parent.Width
                        X: =0
                        Y: =0
                        ZIndex: =2

                        "new_deviceioconnectionid1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="new_deviceioconnectionid"
                            FieldName: ="new_deviceioconnectionid"
                            FieldType: ="g"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =14

                        "new_name1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="new_name"
                            FieldName: ="new_name"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =3
                            ZIndex: =15

                        "new_tipodeconexao1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="new_tipodeconexao"
                            FieldName: ="new_tipodeconexao"
                            FieldType: ="l"
                            FieldVariantName: ="textualColumn"
                            Order: =4
                            ZIndex: =16

                        "new_direcao1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="new_direcao"
                            FieldName: ="new_direcao"
                            FieldType: ="l"
                            FieldVariantName: ="textualColumn"
                            Order: =5
                            ZIndex: =17

                        "ConnectedToName1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="ConnectedToName"
                            FieldName: ="ConnectedToName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =6
                            ZIndex: =18

                        "ConnectedToDeviceName1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="ConnectedToDeviceName"
                            FieldName: ="ConnectedToDeviceName"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =7
                            ZIndex: =19

                        "new_tipodeconexaorawtext1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="new_tipodeconexaorawtext"
                            FieldName: ="new_tipodeconexaorawtext"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =8
                            ZIndex: =20

                        "ConnectedToLocation1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                            FieldDisplayName: ="ConnectedToLocation"
                            FieldName: ="ConnectedToLocation"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =9
                            ZIndex: =21

                    SummaryGalleryTemplateTable As Table.pcfdataset:
                        ContextualLookupColumnFilters: ="yes"
                        DateOnlyFormat: ='PowerAppsOneGrid.DateOnlyFormat'.ShortDate
                        DateTimeFormat: ='PowerAppsOneGrid.DateTimeFormat'.ShortDateTime
                        DisplayMode: =DisplayMode.Edit
                        EnableRangeSelection: ='PowerAppsOneGrid.EnableRangeSelection'.Disable
                        EnableSorting: ='PowerAppsOneGrid.EnableSorting'.Disable
                        Font: ="Lato"
                        FontSize: =11
                        Height: =Parent.Height
                        Items: |-
                            =ForAll(
                                RenameColumns(
                                    ThisItem.Connections,
                                    new_name,
                                    'Porta de Origem',
                                    ConnectedToLocation,
                                    'Local Destino',
                                    ConnectedToDeviceName,
                                    'Dispositivo Destino',
                                    ConnectedToName,
                                    'Porta de Destino'
                                ) As Item,
                                Patch(
                                    Item,
                                    {
                                        'Tipo de Conexão': Text(Item.new_tipodeconexao),
                                        Direção: Text(Item.new_direcao)
                                    }
                                )
                            )
                        LookupFilterBeginsWith: ="no"
                        NoDataText: ="Nenhum dado encontrado"
                        onCellValueChange: =false
                        onFilter: =false
                        onNavigate: =false
                        onRowSelect: =false
                        onSave: =false
                        OnSelect: =false
                        ReflowBehavior: ='PowerAppsOneGrid.ReflowBehavior'.GridOnly
                        ShowAvatar: ="no"
                        ShowColumnHeaders: ="yes"
                        ShowFooter: ="no"
                        Width: =Parent.Width-Self.X+50
                        X: =-50
                        Y: =0
                        ZIndex: =3

                        "'Porta de Origem1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            CanGrow: =false
                            FieldDisplayName: ="Porta de Origem"
                            FieldName: ="Porta de Origem"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            Width: =150
                            ZIndex: =22

                        "'Tipo de Conexão2' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            CanGrow: =false
                            FieldDisplayName: ="Tipo de Conexão"
                            FieldName: ="Tipo de Conexão"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            ZIndex: =23

                        Direção1 As PowerAppsOneGridTemplate_dataField.textualColumn:
                            CanGrow: =false
                            FieldDisplayName: ="Direção"
                            FieldName: ="Direção"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =3
                            Width: =80
                            ZIndex: =24

                        "'Local Destino1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            CanGrow: =false
                            FieldDisplayName: ="Local Destino"
                            FieldName: ="Local Destino"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =4
                            Width: =110
                            ZIndex: =25

                        "'Dispositivo Destino1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            CanGrow: =false
                            FieldDisplayName: ="Dispositivo Destino"
                            FieldName: ="Dispositivo Destino"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =5
                            Width: =180
                            ZIndex: =26

                        "'Porta de Destino1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            CanGrow: =true
                            FieldDisplayName: ="Porta de Destino"
                            FieldName: ="Porta de Destino"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =6
                            Width: =220
                            ZIndex: =27

        FooterContainer_1 As groupContainer.verticalAutoLayoutContainer:
            FillPortions: =0
            Height: =29
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =12

            Container1_1 As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =0
                Height: |
                    =29
                LayoutGridColumns: =6
                LayoutGridRows: =6
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =100
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =4

                SpacerContainer As groupContainer.manualLayoutContainer:
                    LayoutGridColumns: =6
                    LayoutGridRows: =6
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =100
                    LayoutMinWidth: =0
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    ZIndex: =1

                FooterPageLabel As Label:
                    AcceptsFocus: =false
                    Alignment: =Align.Right
                    AutoHeight: =true
                    Color: =
                    DisplayMode: =DisplayMode.Edit
                    FillPortions: =1
                    Font: =Font.Lato
                    FontWeight: =FontWeight.Semibold
                    Height: =32
                    Italic: =false
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =32
                    OnChange: =false
                    Strikethrough: =false
                    Text: =CurrentPage&" de "&Max(SummaryItems,Page)
                    Underline: =false
                    Width: =100
                    X: =Parent.Width-Self.Width-10
                    Y: =SummaryNovoPageContainer.Y+SummaryNovoPageContainer.Height-Self.Height-10
                    ZIndex: =3

    Button8_1 As Button:
        BorderColor: =
        DisabledBorderColor: =
        DisabledFillColor: =
        DisabledTextColor: =
        DisplayMode: =DisplayMode.Edit
        FillColor: =
        Height: =32
        HoverBorderColor: =
        HoverFillColor: =
        HoverTextColor: =
        OnChange: =false
        OnSelect: |-
            =UpdateContext({CurrentPage: Max(CurrentPage-1,1)})
        PressedBorderColor: =
        PressedFillColor: =
        PressedTextColor: =
        Text: ="Page -"
        TextColor: =
        Visible: =!Parent.Printing
        Width: =96
        X: =548
        Y: =1002
        ZIndex: =2

    Button8 As Button:
        BorderColor: =
        DisabledBorderColor: =
        DisabledFillColor: =
        DisabledTextColor: =
        DisplayMode: =DisplayMode.Edit
        FillColor: =
        Height: =32
        HoverBorderColor: =
        HoverFillColor: =
        HoverTextColor: =
        OnChange: =false
        OnSelect: |
            =UpdateContext(
                {
                    CurrentPage: Min(
                        CurrentPage + 1,
                        Max(
                            SummaryItems,
                            Page
                        )
                    )
                }
            );
        PressedBorderColor: =
        PressedFillColor: =
        PressedTextColor: =
        Text: ="Page +"
        TextColor: =
        Visible: =!Parent.Printing
        Width: =96
        X: =663
        Y: =1002
        ZIndex: =3

    PDFIcon As icon.Print:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(0, 120, 212, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        Height: =32
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.DocumentPDF
        OnSelect: |-
            =UpdateContext({PrintDestination: Blank()});
            Select(PrintingTimer)
            /*With(
                {Value: PDF(SummaryNovoPageContainer)}As File,
                Download(
                    '(PDF)-UploadPDFFile'.Run(
                        {
                            file: {
                                name: "proposta" & RandBetween(
                                    1,
                                    1000
                                ) & "_" & Now() & ".pdf",
                                contentBytes: File.Value
                            }
                        }
                    ).url
                )
            )*/
        PaddingBottom: =3
        PaddingLeft: =3
        PaddingRight: =3
        PaddingTop: =3
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =!Parent.Printing
        Width: =32
        X: =67
        Y: =1066
        ZIndex: =4

    PrintingTimer As timer:
        BorderColor: =RGBA(0, 120, 212, 1)
        BorderStyle: =BorderStyle.None
        DisabledBorderColor: =RGBA(244, 244, 244, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Duration: =20000
        Fill: =RGBA(0, 120, 212, 1)
        FocusedBorderThickness: =2
        Font: =Font.'Segoe UI'
        HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -10%)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 120, 212, 1), -10%)
        OnSelect: |-
            =UpdateContext(
                {
                    CurrentPage: 1,
                    SpinCounter2: SpinCounter2 + 1
                }
            );
            Clear(FilePathCollection);
            Set(
                StartTimerFlag,
                true
            );
        OnTimerEnd: |-
            =If(
                StartTimerFlag,
                With(
                    {Value: PDF(SummaryNovoPageContainer)}As File,
                    With(
                        '(PDF)-UploadPDFFile'.Run(
                            {
                                file: {
                                    name: "proposta" & RandBetween(
                                        1,
                                        1000
                                    ) & "_" & Now() & ".pdf",
                                    contentBytes: File.Value
                                }
                            }
                        ) As Result,
                        Collect(
                            FilePathCollection,
                            Result
                        );
                        //Download(Result.url)
                    )
                );
                If(
                    CurrentPage < Max(
                        SummaryItems,
                        Page
                    ),
                    UpdateContext({CurrentPage: CurrentPage + 1}),
                    Set(
                        StartTimerFlag,
                        false
                    );
                    If(
                        IsBlank(PrintDestination),
                        Download(
                            '(PDF)-MergePDFs'.Run(
                                Concat(
                                    FilePathCollection As File,
                                    File.filepath,
                                    "; "
                                )
                            ).filepath
                        ),
                        '(PDF)-MergePDFsandSendToEmailAddress'.Run(
                            Concat(
                                FilePathCollection As File,
                                File.filepath,
                                "; "
                            ),
                            PrintDestination
                        )
                    );
                    UpdateContext({SpinCounter2: SpinCounter2 - 1})
                )
            )
        OnTimerStart: =
        PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        Repeat: =StartTimerFlag
        Size: =10.5
        Start: =StartTimerFlag
        Visible: =SpinCounter2 > 0
        X: =99
        Y: =891
        ZIndex: =5

    CtnSpinner_1 As groupContainer.manualLayoutContainer:
        ContentLanguage: =
        Fill: =RGBA(0, 0, 0, 0.15)
        Height: =Parent.Height
        LayoutGridColumns: =6
        LayoutGridRows: =6
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Visible: =SpinCounter2 > 0
        Width: =Parent.Width
        ZIndex: =6

        Container6_1 As groupContainer.manualLayoutContainer:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height*.4
            LayoutGridColumns: =6
            LayoutGridRows: =6
            RadiusBottomLeft: =Self.RadiusTopLeft
            RadiusBottomRight: =Self.RadiusTopLeft
            RadiusTopLeft: =Min(Self.Width,Self.Height)*.05
            RadiusTopRight: =Self.RadiusTopLeft
            Width: =Parent.Width*.4
            X: =(Parent.Width-Self.Width)/2
            Y: =(Parent.Height-Self.Height)/2
            ZIndex: =4

            "Spinner2_1 As 'Fluent Spinner (1.1.29) Preview'":
                BackgroundColor: |-
                    ="#ffffff00"
                DisplayMode: =DisplayMode.Edit
                Height: =Parent.Height
                Label: ="Carregando"
                LabelPosition: ='PowerCAT.Spinner.LabelPosition'.Bottom
                SpinnerAlignment: ='PowerCAT.Spinner.SpinnerAlignment'.Center
                SpinnerSize: ='PowerCAT.Spinner.SpinnerSize'.Large
                Theme: =AppThemeJson
                Width: =Parent.Width
                X: =(Parent.Width-Self.Width)/2
                Y: =(Parent.Height-Self.Height)/2
                ZIndex: =1

    CloseIcon As icon.Print:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(0, 120, 212, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        Height: =32
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Cancel
        OnSelect: =Select(SummaryHeaderLogo)
        PaddingBottom: =3
        PaddingLeft: =3
        PaddingRight: =3
        PaddingTop: =3
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =!Parent.Printing
        Width: =32
        X: =20
        Y: =1066
        ZIndex: =7

    MailIcon As icon.Print:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(0, 120, 212, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        Height: =32
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Mail
        OnSelect: |-
            =UpdateContext({PrintDestination: User().Email});
            Select(PrintingTimer)
            /*With(
                {Value: PDF(SummaryNovoPageContainer)}As File,
                Download(
                    '(PDF)-UploadPDFFile'.Run(
                        {
                            file: {
                                name: "proposta" & RandBetween(
                                    1,
                                    1000
                                ) & "_" & Now() & ".pdf",
                                contentBytes: File.Value
                            }
                        }
                    ).url
                )
            )*/
        PaddingBottom: =3
        PaddingLeft: =3
        PaddingRight: =3
        PaddingTop: =3
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =!Parent.Printing
        Width: =32
        X: =115
        Y: =1066
        ZIndex: =8

