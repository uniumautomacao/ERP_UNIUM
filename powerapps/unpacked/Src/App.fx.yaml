App As appinfo:
    BackEnabled: =false
    Formulas: |-
        =ProdutosPedido = ShowColumns(
            SortByColumns(
                Filter(
                    'Produtos-Serviço' As P,
                    !IsBlank(P.'Ordem de Serviço'),
                    P.Status = 'Status (Produtos-Serviço)'.Active,
                    P.'Efetuar Pedido' = 'Efetuar Pedido (Produtos-Serviço)'.Yes,
                    !IsBlank(P.'Fornecedor Principal Id'),
                    Or(
                        IsBlank(P.Cotação),
                        P.Cotação.Status <> 'Status (Cotações)'.Active
                    )
                ),
                "new_previsaodeentrega",
                SortOrder.Ascending,
                "new_nomedoclientefx",
                SortOrder.Ascending,
                "new_referenciadoproduto",
                SortOrder.Ascending
            ),
            'Produto-Serviço',
            'Nome do Cliente (Fx)',
            'Referência do Produto',
            'Entrega Próxima',
            'Previsão de Entrega',
            Descrição,
            Quantidade,
            'Fornecedor Principal Id',
            'Nome do Fabricante V2'
        );
        Fornecedores = Filter(
            AddColumns(
                SortByColumns(
                    Filter(
                        'Fornecedores From Sharepoint Lists' As F,
                        F.Status = 'Status (Fornecedores From Sharepoint Lists)'.Active,
                        !IsBlank(F.NomeFantasia),
                        !IsBlank(F.RazãoSocial)
                    ),
                    "cr22f_nomefantasia",
                    SortOrder.Ascending
                ) As F,
                Counter,
                CountIf(
                    ProdutosPedido As P,
                    P.new_fornecedorprincipalid = F.ID
                )
            ) As F,
            F.Counter > 0
        );
        ProdutosFornecedor = AddColumns(
            GroupBy(
                Filter(
                    ProdutosPedido As P,
                    P.new_fornecedorprincipalid = FornecedorSelecionadoId
                ),
                new_nomedoclientefx,
                new_referenciadoproduto,
                new_entregaproxima,
                new_produtoservicoid,
                new_previsaodeentrega,
                new_descricao,
                new_fornecedorprincipalid,
                new_nomedofabricantev2,
                Produtos
            ) As Prods,
            new_quantidade,
            Sum(
                Prods.Produtos As P,
                P.new_quantidade
            ),
            DataEntrega,
            Text(
                Prods.new_previsaodeentrega,
                DateTimeFormat.ShortDate,
                "pt-BR"
            ),
            Selecionado,
            Prods.new_produtoservicoid in IdsSelecionados
        );
        ProdutosSelecionados = Filter(
            ProdutosFornecedor As P,
            P.Selecionado = true
        );
    OnStart: |
        =Set(AppTheme, {
        	palette: {
        		themePrimary: "#0078d4",
        		themeLighterAlt: "#eff6fc",
        		themeLighter: "#deecf9",
        		themeLight: "#c7e0f4",
        		themeTertiary: "#71afe5",
        		themeSecondary: "#2b88d8",
        		themeDarkAlt: "#106ebe",
        		themeDark: "#005a9e",
        		themeDarker: "#004578",
        		neutralLighterAlt: "#faf9f8",
        		neutralLighter: "#f3f2f1",
        		neutralLight: "#edebe9",
        		neutralQuaternaryAlt: "#e1dfdd",
        		neutralQuaternary: "#d0d0d0",
        		neutralTertiaryAlt: "#c8c6c4",
        		neutralTertiary: "#a19f9d",
        		neutralSecondary: "#605e5c",
        		neutralPrimaryAlt: "#3b3a39",
        		neutralPrimary: "#323130",
        		neutralDark: "#201f1e",
        		black: "#000000",
        		white: "#ffffff"
        	}
        });
        
        
        Set(AppThemeJson, JSON(AppTheme,JSONFormat.IndentFour));
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

