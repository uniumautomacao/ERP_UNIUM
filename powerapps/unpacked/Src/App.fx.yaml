App As appinfo:
    BackEnabled: =false
    Formulas: |-
        =CurrentUser = LookUp(
            Users As U,
            U.'Primary Email' = User().Email
        );
        LaneWidth = (RMASGallery.Width - RMASGallery.TemplatePadding*(RMASGallery.AllItemsCount + 1)) / RMASGallery.AllItemsCount;
        RMASAtivos = SortByColumns(
            Filter(
                RMAS As L,
                L.Status = 'Status (RMAS)'.Active,
                L.Situação <> 'RMA Stage'.Devolvido
            ),
            "new_lembreteexpirado",
            SortOrder.Descending,
            "new_posicao",
            SortOrder.Ascending
        );
        Estagios = SortByColumns(
            Filter(
                Choices('RMA Stage') As V,
                V.Value <> 'RMA Stage'.Devolvido
            ),
            "Value",
            SortOrder.Ascending
        );
        EstagiosSelecionados = With(
            {
                Values: Filter(
                    AppPreferences As P,
                    P.User.'Primary Email' = User().Email,
                    P.BoolValue = true,
                    StartsWith(
                        P.'Preference Key',
                        "EstagioQuadroRMA_"
                    )
                )
            } As Selecionados,
            Filter(
                Estagios As E,
                E.Value in ForAll(
                    Selecionados.Values As S,
                    Last(
                        Split(
                            S.'Preference Key',
                            "_"
                        )
                    ).Value
                )
            )
        );
    OnStart: |
        =Set(AppTheme, {
        	palette: {
        		themePrimary: "#0078d4",
        		themeLighterAlt: "#eff6fc",
        		themeLighter: "#deecf9",
        		themeLight: "#c7e0f4",
        		themeTertiary: "#71afe5",
        		themeSecondary: "#2b88d8",
        		themeDarkAlt: "#106ebe",
        		themeDark: "#005a9e",
        		themeDarker: "#004578",
        		neutralLighterAlt: "#faf9f8",
        		neutralLighter: "#f3f2f1",
        		neutralLight: "#edebe9",
        		neutralQuaternaryAlt: "#e1dfdd",
        		neutralQuaternary: "#d0d0d0",
        		neutralTertiaryAlt: "#c8c6c4",
        		neutralTertiary: "#a19f9d",
        		neutralSecondary: "#605e5c",
        		neutralPrimaryAlt: "#3b3a39",
        		neutralPrimary: "#323130",
        		neutralDark: "#201f1e",
        		black: "#000000",
        		white: "#ffffff"
        	}
        });
        
        
        Set(AppThemeJson, JSON(AppTheme,JSONFormat.IndentFour));
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

