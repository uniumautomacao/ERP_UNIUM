"'Home Screen' As screen":
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =If(
            IsBlank(SpinCounter),
            UpdateContext({SpinCounter: 0});
            Reset(ProjetoComboboxCanvas);
            Reset(OSComboboxCanvas)
        );
        Select(RefreshButton)

    RootLayoutContainer_HS As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(250, 250, 250, 1)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGridColumns: =6
        LayoutGridRows: =6
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =App.Width
        ZIndex: =1

        CommandContainer_HS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =44
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =3

            "CommandBar1 As 'Fluent Command Bar (1.1.29)'.pcfdataset":
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                Items: |-
                    =Table(
                        {
                            ItemKey: "Back",
                            ItemIconName: "Back",
                            ItemDisplayName: "Voltar"
                        },{
                            ItemKey: "Refresh",
                            ItemIconName: "Refresh",
                            ItemDisplayName: "Atualizar"
                        }
                    )
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =200
                LayoutMinWidth: =200
                OnSelect: |-
                    =Switch(
                        Self.Selected.ItemKey,
                        "Back",
                        Back(),
                        Select(RefreshButton)
                    )
                Theme: =AppThemeJson
                Width: =600 
                X: =0
                Y: =0
                ZIndex: =1

            TextCanvas1 As Text:
                Align: ='TextCanvas.Align'.Center
                BorderColor: =
                DisplayMode: =DisplayMode.Edit
                Fill: =
                FontColor: =
                Height: =32
                LayoutMaxHeight: =0
                LayoutMaxWidth: =0
                LayoutMinHeight: =16
                LayoutMinWidth: =16
                Text: ="V0.37"
                VerticalAlign: =VerticalAlign.Middle
                Width: =96
                X: =0
                Y: =0
                ZIndex: =2

            RefreshButton As Button:
                BasePaletteColor: =
                BorderColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =32
                LayoutMaxHeight: =0
                LayoutMaxWidth: =0
                LayoutMinHeight: =16
                LayoutMinWidth: =16
                OnSelect: |-
                    =UpdateContext({SpinCounter: SpinCounter + 1});
                    Concurrent(
                        Refresh('Estoque-RMAS'),
                        Refresh(AppPreferences),
                        Refresh('Produtos-Serviço'),
                        Refresh(Projetos)
                    );
                    UpdateContext({SpinCounter: SpinCounter - 1})
                Visible: =false
                Width: =96
                X: =0
                Y: =0
                ZIndex: =3

            ButtonCanvas2 As Button:
                BasePaletteColor: =
                BorderColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =32
                LayoutMaxHeight: =0
                LayoutMaxWidth: =0
                LayoutMinHeight: =16
                LayoutMinWidth: =16
                OnSelect: |-
                    =Concurrent(
                            Refresh(AppPreferences),
                            Refresh(Users),
                            Refresh('Estoque-RMAS'),
                            Refresh(RMAS),
                            Refresh('Estoque From SharepointLists'),
                            Refresh('Produtos-Serviço'),
                            Refresh(Projetos),
                            Refresh('Ordens de Serviço Field Control'),
                            Refresh('Atividades Field Control'),
                            Reset(ProjetoComboboxCanvas),
                            Reset(OSComboboxCanvas)
                        )
                Visible: =false
                Width: =96
                X: =0
                Y: =0
                ZIndex: =4

        SubheaderContainer_HS As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =70
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =10
            PaddingRight: =10
            ZIndex: =4

            lbTitleCodeReview As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(20, 0, 0, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FillPortions: =1
                FocusedBorderThickness: =4
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Height: =70
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                PaddingLeft: =20
                Text: ="Cadastro de Retorno de Mercadoria | " & First(ProjetoSelecionado).Apelido
                Width: =240
                Y: =241
                ZIndex: =1

        ContentContainer_HS As groupContainer.verticalAutoLayoutContainer:
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =5

            BodyContainer As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.Light
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutGap: =10
                LayoutGridColumns: =6
                LayoutGridRows: =6
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMaxHeight: =0
                LayoutMaxWidth: =0
                LayoutMinHeight: =16
                LayoutMinWidth: =16
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =1

                MercadoriasContainer As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.Light
                    Fill: =RGBA(255, 255, 255, 1)
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutGridColumns: =6
                    LayoutGridRows: =6
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMaxHeight: =0
                    LayoutMaxWidth: =0
                    LayoutMinHeight: =16
                    LayoutMinWidth: =16
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =8
                    PaddingLeft: =8
                    PaddingRight: =8
                    PaddingTop: =8
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    ZIndex: =6

                    RMAInfoHeaderText As Text:
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =false
                        BorderColor: =
                        BorderStyle: =""
                        ContentLanguage: =""
                        DisplayMode: =DisplayMode.Edit
                        Fill: =
                        Font: =Font.Lato
                        FontColor: =
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        Height: =32
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        Size: =14
                        TabIndex: =0
                        Text: ="Informações do RMA"
                        Tooltip: =""
                        VerticalAlign: =VerticalAlign.Middle
                        Visible: =true
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =96
                        Wrap: =true
                        X: =0
                        Y: =0
                        ZIndex: =1

                    FormRowContainer_2 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        ZIndex: =2

                        FormRowLabelText_2 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Projeto"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =120
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        ProjetoComboboxCanvas As Combobox.pcfdataset:
                            AccessibleLabel: =""
                            Appearance: ="FilledDarker"
                            BorderStyle: =""
                            ContentLanguage: =""
                            DefaultSelectedItems: =[LookUp(Projetos As P,P.Projeto = RMASelecionado.Projeto.Projeto)]//ProjetoSelecionado
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            Font: =""
                            FontItalic: =false
                            FontSize: =0
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            InputTextPlaceholder: ="Buscar projetos"
                            IsSearchable: =true
                            Items: |-
                                =Search(
                                    Projetos,
                                    Self.SearchText,
                                    Apelido
                                )
                            LayoutMaxHeight: =32
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =32
                            LayoutMinWidth: =16
                            MultiValueDelimiter: =", "
                            OnChange: |-
                                =Patch(
                                    RMAS,
                                    LookUp(// registro que será atualizado
                                        RMAS,
                                        RMA = RMAId// condição pra achar o RMA certo
                                    ),
                                    {
                                        Projeto: LookUp(
                                            Projetos As P,
                                            P.Projeto = Self.Selected.Projeto
                                        )// ou Self.Selected se estiver no próprio ComboBox
                                    }
                                );
                                ClearCollect(
                                    ProjetoSelecionado,
                                    If(
                                        !IsBlank(RMASelecionado.Projeto),
                                        LookUp(
                                            Projetos As P,
                                            P.Projeto = RMASelecionado.Projeto.Projeto
                                        )
                                    )
                                );
                                Reset(OSComboboxCanvas)
                            Required: =false
                            SelectMultiple: =false
                            TabIndex: =0
                            Tooltip: =""
                            TriggerOutput: ='ComboboxCanvas.TriggerOutput'.Keypress
                            ValidationState: ="None"
                            Visible: =true
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =2

                            Apelido1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="Apelido"
                                FieldName: ="cr22f_apelido"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =1

                            Ano1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="Ano"
                                FieldName: ="cr22f_ano"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =2
                                ZIndex: =2

                    FormRowContainer_4 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        ZIndex: =3

                        FormRowLabelText_4 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="OS"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =120
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        OSComboboxCanvas As Combobox.pcfdataset:
                            AccessibleLabel: =""
                            Appearance: ="FilledDarker"
                            BorderStyle: =""
                            ContentLanguage: =""
                            DefaultSelectedItems: |-
                                =[
                                    LookUp(
                                        'Ordens de Serviço Field Control' As OS,
                                        OS.'Ordem de Serviço Field Control' = RMASelecionado.'Ordem de Serviço'.'Ordem de Serviço Field Control'
                                    )
                                ]//OSSelecionada
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            Font: =""
                            FontItalic: =false
                            FontSize: =0
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            InputTextPlaceholder: ="Buscar OS"
                            IsSearchable: =true
                            Items: |-
                                =AddColumns(
                                    Search(
                                        Filter(
                                            'Ordens de Serviço Field Control' As OS,
                                            !IsBlank(OS.Projeto),
                                            OS.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto
                                        ),
                                        Self.SearchText,
                                        Name,
                                        'Nome do Cliente (Fx)'
                                    ) As OS,
                                    _Label,
                                    OS.Name & " - " & First(
                                        SortByColumns(
                                            Filter(
                                                'Atividades Field Control' As T,
                                                !IsBlank(T.'Ordem de Serviço Field Control'),
                                                T.'Ordem de Serviço'.'Ordem de Serviço Field Control' = OS.'Ordem de Serviço Field Control',
                                                T.'Status Atividade' = "done"
                                            ),
                                            "new_agendamento",
                                            SortOrder.Descending
                                        )
                                    ).Agendamento
                                )
                            LayoutMaxHeight: =32
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =32
                            LayoutMinWidth: =16
                            MultiValueDelimiter: =", "
                            OnChange: |-
                                =Patch(
                                    RMAS,
                                    LookUp(// registro que será atualizado
                                        RMAS,
                                        RMA = RMAId// condição pra achar o RMA certo
                                    ),
                                    {
                                        'Ordem de Serviço': LookUp(
                                            'Ordens de Serviço Field Control' As OS,
                                            OS.'Ordem de Serviço Field Control' = Self.Selected.'Ordem de Serviço Field Control'
                                        )// ou Self.Selected se estiver no próprio ComboBox
                                    }
                                );
                                ClearCollect(
                                    OSSelecionada,
                                    If(
                                        !IsBlank(RMASelecionado.'Ordem de Serviço'),
                                        LookUp(
                                            'Ordens de Serviço Field Control' As OS,
                                            OS.'Ordem de Serviço Field Control' = RMASelecionado.'Ordem de Serviço'.'Ordem de Serviço Field Control'
                                        )
                                    )
                                )
                            Required: =false
                            SelectMultiple: =false
                            TabIndex: =0
                            Tooltip: =""
                            TriggerOutput: ='ComboboxCanvas.TriggerOutput'.Keypress
                            ValidationState: ="None"
                            Visible: =true
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =2

                            _Label2 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="_Label"
                                FieldName: ="_Label"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =1

                    FormRowContainer_7 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        ZIndex: =4

                        FormRowLabelText_7 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Situação"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =120
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =2

                        SituacaoComboboxCanvas As Combobox.pcfdataset:
                            AccessibleLabel: =""
                            Appearance: ="FilledDarker"
                            BorderStyle: =""
                            ContentLanguage: =""
                            DefaultSelectedItems: =[RMASelecionado.Situação]
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            Font: =""
                            FontItalic: =false
                            FontSize: =0
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            InputTextPlaceholder: ="Escolha a situação"
                            IsSearchable: =true
                            Items: =Choices('RMA Stage')
                            LayoutMaxHeight: =32
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =32
                            LayoutMinWidth: =16
                            MultiValueDelimiter: =", "
                            OnChange: |-
                                =Patch(
                                    RMAS,
                                    LookUp(// registro que será atualizado
                                        RMAS,
                                        RMA = RMAId// condição pra achar o RMA certo
                                    ),
                                    {
                                        Situação: Self.Selected.Value
                                    }
                                )
                            Required: =false
                            SelectMultiple: =false
                            TabIndex: =0
                            Tooltip: =""
                            TriggerOutput: ='ComboboxCanvas.TriggerOutput'.Keypress
                            ValidationState: ="None"
                            Visible: =true
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =3

                            Value1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="Value"
                                FieldName: ="Value"
                                FieldType: ="l"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =1

                    FormRowContainer_8 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =100
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        ZIndex: =5

                        FormRowLabelText_8 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Observações"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =120
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        "TextInputCanvas1 As 'Text input'":
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FillPortions: =1
                            FontColor: =
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =16
                            LayoutMinWidth: =16
                            OnChange: |-
                                =Patch(
                                    RMAS,{RMA:RMASelecionado.RMA,Observações:Self.Value}
                                )
                            Value: =RMASelecionado.Observações
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =2

                    MercadoriasHeaderText As Text:
                        Align: ='TextCanvas.Align'.Center
                        BorderColor: =
                        DisplayMode: =DisplayMode.Edit
                        Fill: =
                        Font: =Font.Lato
                        FontColor: =
                        Height: =24
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        Text: ="Mercadorias Devolvidas"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =96
                        X: =0
                        Y: =0
                        ZIndex: =6

                    "MercadoriasCommandBar As 'Fluent Command Bar (1.1.29)'.pcfdataset":
                        AccessibilityLabel: =""
                        ContentLanguage: =""
                        DisplayMode: =DisplayMode.Edit
                        Height: =32
                        InputEvent: =""
                        Items: |-
                            =Table(
                                {
                                    ItemKey: "New",
                                    ItemIconName: "Add",
                                    ItemDisplayName: "Nova Mercadoria"
                                }
                            )
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =200
                        LayoutMinWidth: =200
                        OnChange: =false
                        OnSelect: |-
                            =Switch(
                                Self.Selected.ItemKey,
                                "New",
                                Set(
                                    NovoCadastro,
                                    true
                                )
                            )
                        TabIndex: =0
                        Theme: =AppThemeJson
                        Tooltip: ="Command Bar component"
                        Visible: =true
                        Width: =600 
                        X: =0
                        Y: =0
                        ZIndex: =7

                    MercadoriasTable As Table.pcfdataset:
                        DateOnlyFormat: ='PowerAppsOneGrid.DateOnlyFormat'.ShortDate
                        DateTimeFormat: ='PowerAppsOneGrid.DateTimeFormat'.ShortDateTime
                        DisplayMode: =DisplayMode.Edit
                        FillPortions: =1
                        Height: =If(Self.Y + 500 > Parent.Height, Parent.Height - Self.Y, 500)
                        Items: |-
                            =SortByColumns(
                                Filter(
                                    'Estoque-RMAS' As ER,
                                    !IsBlank(ER.RMA),
                                    ER.RMA.RMA = RMAId
                                ),
                                "createdon",
                                SortOrder.Descending
                            )
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        onCellValueChange: =false
                        onFilter: =false
                        onNavigate: =false
                        onRowSelect: =false
                        onSave: =false
                        OnSelect: |-
                            =Set(
                                NovoCadastro,
                                false
                            );
                            Set(
                                EstoqueRMASelecionadoId,
                                Self.Selected.RMA
                            )
                        Width: =If(Self.X + 800 > Parent.Width, Parent.Width - Self.X, 800)
                        X: =0
                        Y: =0
                        ZIndex: =8

                        "'Etiqueta Produto Antigo1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Etiqueta Produto Antigo"
                            FieldName: ="new_etiquetaprodutoantigo"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =1
                            Width: =0
                            ZIndex: =1

                        "'Etiqueta Produto Novo1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Etiqueta Produto Novo"
                            FieldName: ="new_etiquetaprodutonovo"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =2
                            Width: =0
                            ZIndex: =2

                        "'Tipo de RMA1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Tipo de RMA"
                            FieldName: ="new_tipoderma"
                            FieldType: ="l"
                            FieldVariantName: ="textualColumn"
                            Order: =3
                            Width: =0
                            ZIndex: =3

                        "'Referência do Produto1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Referência do Produto"
                            FieldName: ="new_referenciadoproduto"
                            FieldType: ="s"
                            FieldVariantName: ="textualColumn"
                            Order: =5
                            Width: =0
                            ZIndex: =5

                        "'Created On1' As PowerAppsOneGridTemplate_dataField.textualColumn":
                            FieldDisplayName: ="Created On"
                            FieldName: ="createdon"
                            FieldType: ="d"
                            FieldVariantName: ="textualColumn"
                            Order: =5
                            Width: =0
                            ZIndex: =5

                MercadoriasContainer_1 As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.Light
                    Fill: =RGBA(255, 255, 255, 1)
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =10
                    LayoutGridColumns: =6
                    LayoutGridRows: =6
                    LayoutMaxHeight: =0
                    LayoutMaxWidth: =0
                    LayoutMinHeight: =16
                    LayoutMinWidth: =16
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =8
                    PaddingLeft: =8
                    PaddingRight: =8
                    PaddingTop: =8
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Visible: =ShowMercadoriaInfo
                    ZIndex: =7

                    DetalhesMercadoriaHeaderText As Text:
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =false
                        BorderColor: =
                        BorderStyle: =""
                        ContentLanguage: =""
                        DisplayMode: =DisplayMode.Edit
                        Fill: =
                        Font: =Font.Lato
                        FontColor: =
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        Height: =32
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        Size: =14
                        TabIndex: =0
                        Text: ="Detalhes da Mercadoria"
                        Tooltip: =""
                        VerticalAlign: =VerticalAlign.Middle
                        Visible: =true
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =96
                        Wrap: =true
                        X: =0
                        Y: =0
                        ZIndex: =1

                    FormRowContainer As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        ZIndex: =2

                        FormRowLabelText As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Tipo Devolução"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =200
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =2

                        TipoDevolucaoDropdown As Dropdown.pcfdataset:
                            AlignInContainer: =AlignInContainer.End
                            DefaultSelectedItems: =[]
                            DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                            FillPortions: =1
                            Height: =32
                            Items: =Choices('Tipo de RMA')
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =16
                            LayoutMinWidth: =16
                            OnChange: =Reset(ProdutoAntigoCombobox)
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =3

                    FormRowContainer_1 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Visible: |-
                            =TipoDevolucaoDropdown.Selected.Value in [
                                'Tipo de RMA'.'Devolução de Empréstimo',
                                'Tipo de RMA'.'Devolução Definitiva do Produto',
                                'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                'Tipo de RMA'.'Retorno Para Troca de Produto'
                            ]
                        ZIndex: =3

                        FormRowLabelText_1 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Produto Antigo"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =200
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =2

                        ProdutoAntigoCombobox As Combobox.pcfdataset:
                            DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                            FillPortions: =1
                            Height: =32
                            InputTextPlaceholder: ="Buscar mercadorias"
                            Items: |-
                                =AddColumns(
                                    Switch(
                                        TipoDevolucaoDropdown.Selected.Value,
                                        'Tipo de RMA'.'Devolução de Empréstimo',
                                        Search(
                                            Filter(
                                                'Estoque From SharepointLists' As E,
                                                !IsBlank(E.'Produto-Serviço'),
                                                E.'Produto-Serviço'.'É Empréstimo' = 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                E.'Produto-Serviço'.'Empréstimo Devolvido' <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                Or(
                                                    E.Situação = "Entregue",
                                                    E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                )
                                            ),
                                            Self.SearchText,
                                            'Referência do Produto',
                                            'Etiqueta Em Texto (Calculated)'
                                        ),
                                        'Tipo de RMA'.Manutenção,
                                        Search(
                                            Filter(
                                                'Estoque From SharepointLists' As E,
                                                !IsBlank(E.'Produto-Serviço'),
                                                E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                E.'Produto-Serviço'.'Empréstimo Devolvido' <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                Or(
                                                    E.Situação = "Entregue",
                                                    E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                ),
                                                E.Quantidade = 1
                                            ),
                                            Self.SearchText,
                                            'Referência do Produto',
                                            'Etiqueta Em Texto (Calculated)'
                                        ),
                                        'Tipo de RMA'.'Devolução Definitiva do Produto',
                                        Search(
                                            Filter(
                                                'Estoque From SharepointLists' As E,
                                                !IsBlank(E.'Produto-Serviço'),
                                                E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                Or(
                                                    E.Situação = "Entregue",
                                                    E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                ),
                                                E.'Quantidade Disponível Devolução' > 0
                                            ),
                                            Self.SearchText,
                                            'Referência do Produto',
                                            'Etiqueta Em Texto (Calculated)'
                                        ),
                                        'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                        Search(
                                            Filter(
                                                'Estoque From SharepointLists' As E,
                                                !IsBlank(E.'Produto-Serviço'),
                                                E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                Or(
                                                    E.Situação = "Entregue",
                                                    E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                ),
                                                E.Quantidade = 1
                                            ),
                                            Self.SearchText,
                                            'Referência do Produto',
                                            'Etiqueta Em Texto (Calculated)'
                                        ),
                                        'Tipo de RMA'.'Retorno Para Troca de Produto',
                                        Search(
                                            Filter(
                                                'Estoque From SharepointLists' As E,
                                                !IsBlank(E.'Produto-Serviço'),
                                                E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                E.'Produto-Serviço'.Projeto.Projeto = ProjetoComboboxCanvas.Selected.Projeto,
                                                Or(
                                                    E.Situação = "Entregue",
                                                    E.'Produto-Serviço'.Entregue = 'Entregue (Produtos-Serviço)'.Yes
                                                ),
                                                E.Quantidade = 1
                                            ),
                                            Self.SearchText,
                                            'Referência do Produto',
                                            'Etiqueta Em Texto (Calculated)'
                                        )
                                    ) As E,
                                    _Label,
                                    E.'Etiqueta Em Texto (Calculated)' & " - " & E.'Referência do Produto'
                                )
                            LayoutMaxHeight: =32
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =32
                            LayoutMinWidth: =16
                            OnChange: |-
                                =Set(
                                    _SN,
                                    LookUp(
                                        'Estoque From SharepointLists' As E,
                                        E.'Estoque From SharepointList' = Self.Selected.'Estoque From SharepointList',
                                        E.'Número de Série'
                                    )
                                )
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =3

                            new_etiquetaemtextocalculated1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="new_etiquetaemtextocalculated"
                                FieldName: ="new_etiquetaemtextocalculated"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =3
                                ZIndex: =2

                            _Label1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="_Label"
                                FieldName: ="_Label"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =2
                                ZIndex: =3

                            new_referenciadoproduto1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="new_referenciadoproduto"
                                FieldName: ="new_referenciadoproduto"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =3
                                ZIndex: =3

                    FormRowContainer_9 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Visible: |-
                            =TipoDevolucaoDropdown.Selected.Value in [
                                'Tipo de RMA'.'Devolução de Empréstimo',
                                'Tipo de RMA'.'Devolução Definitiva do Produto',
                                'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                'Tipo de RMA'.'Retorno Para Troca de Produto'
                            ]
                        ZIndex: =4

                        FormRowLabelText_9 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Quantidade Devolvida"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =200
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        "NumberInput1 As 'Number input'":
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FillPortions: =1
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =16
                            LayoutMinWidth: =16
                            Max: |-
                                =LookUp(
                                    'Estoque From SharepointLists' As E,
                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                    E.'Quantidade Disponível Devolução'
                                )
                            Min: =1
                            Value: |-
                                =LookUp(
                                    'Estoque From SharepointLists' As E,
                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                    E.'Quantidade Disponível Devolução'
                                )
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =2

                    FormRowContainer_6 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Visible: |-
                            =Or(
                                TipoDevolucaoDropdown.Selected.Value in ['Tipo de RMA'.Manutenção,'Tipo de RMA'.'Devolução Definitiva do Produto']
                            )
                        ZIndex: =5

                        FormRowLabelText_6 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Produto Novo"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =200
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        ProdutoNovoCombobox As Combobox.pcfdataset:
                            AccessibleLabel: =""
                            Appearance: ="FilledDarker"
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                            FillPortions: =1
                            Font: =""
                            FontItalic: =false
                            FontSize: =0
                            FontStrikethrough: =false
                            FontUnderline: =false
                            FontWeight: =""
                            Height: =32
                            InputTextPlaceholder: ="Buscar mercadorias"
                            IsSearchable: =true
                            Items: |-
                                =AddColumns(
                                    Switch(
                                        TipoDevolucaoDropdown.Selected.Value,
                                        'Tipo de RMA'.Manutenção,
                                        SortByColumns(
                                            Search(
                                                Filter(
                                                    'Estoque From SharepointLists' As E,
                                                    IsBlank(E.'Produto-Serviço'),
                                                    E.'Produto-Serviço'.'Empréstimo Devolvido' <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                    E.Situação = "Disponível",
                                                    E.Quantidade = 1
                                                ),
                                                Self.SearchText,
                                                'Referência do Produto',
                                                'Etiqueta Em Texto (Calculated)'
                                            ),
                                            "new_datadaultimaleitura",
                                            SortOrder.Descending
                                        ),
                                        'Tipo de RMA'.'Devolução Definitiva do Produto',
                                        With(
                                            {
                                                EstoqueId: ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                ModeloId: LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    E.'Modelo de Produto'.'Modelos de Produto From Sharepoint List'
                                                )
                                            } As Param,
                                            Search(
                                                Filter(
                                                    'Estoque From SharepointLists' As E,
                                                    !IsBlank(E.'Produto-Serviço'),
                                                    E.'Produto-Serviço'.'Opção de Fornecimento' = 'Opção de Fornecimento'.Padrão,
                                                    E.'Produto-Serviço'.'É Empréstimo' <> 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                    E.Quantidade = NumberInput1.Value,
                                                    E.'Quantidade Disponível Devolução' = NumberInput1.Value,
                                                    E.'Quantidade Disponível Devolução' > 0,
                                                    Or(
                                                        E.'Estoque From SharepointList' = Param.EstoqueId,
                                                        And(
                                                            !IsBlank(E.'Modelo de Produto'),
                                                            E.'Modelo de Produto'.'Modelos de Produto From Sharepoint List' = Param.ModeloId,
                                                            E.Situação = "Disponível"
                                                        )
                                                    )
                                                ),
                                                Self.SearchText,
                                                'Referência do Produto',
                                                'Etiqueta Em Texto (Calculated)'
                                            )
                                        )
                                    ) As E,
                                    _Label,
                                    E.'Etiqueta Em Texto (Calculated)' & " - " & E.'Referência do Produto'
                                )
                            LayoutMaxHeight: =32
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =32
                            LayoutMinWidth: =16
                            MultiValueDelimiter: =", "
                            OnChange: =false
                            Required: =false
                            SelectMultiple: =false
                            TabIndex: =0
                            Tooltip: =""
                            TriggerOutput: ="Keypress"
                            ValidationState: ="None"
                            Visible: =true
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =2

                            new_etiquetaemtextocalculated1_1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="new_etiquetaemtextocalculated"
                                FieldName: ="new_etiquetaemtextocalculated"
                                FieldType: ="s"
                                Order: =3
                                Type: ="s"
                                ZIndex: =1

                            _Label1_1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="_Label"
                                FieldName: ="_Label"
                                FieldType: ="s"
                                Order: =2
                                Type: ="s"
                                ZIndex: =2

                            new_referenciadoproduto1_1 As PowerApps_CoreControls_ComboboxCanvasTemplate_dataField.textualColumn:
                                FieldDisplayName: ="new_referenciadoproduto"
                                FieldName: ="new_referenciadoproduto"
                                FieldType: ="s"
                                Order: =3
                                Type: ="s"
                                ZIndex: =3

                    FormRowContainer_3 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Visible: |-
                            =TipoDevolucaoDropdown.Selected.Value in [
                                'Tipo de RMA'.'Devolução de Empréstimo',
                                'Tipo de RMA'.'Devolução Definitiva do Produto',
                                'Tipo de RMA'.'Retorno Para Troca de Produto'
                            ]
                        ZIndex: =6

                        FormRowLabelText_3 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =200
                            LayoutMinWidth: =200
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Aprovar Para Venda"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =200
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        AprovarVendaToggle As Toggle:
                            BasePaletteColor: =
                            DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                            FillPortions: =1
                            FontColor: =
                            Height: =35
                            Label: =If(Self.Checked = true,"Sim","Não")
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =16
                            LayoutMinWidth: =16
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =113
                            X: =0
                            Y: =0
                            ZIndex: =2

                    FormRowContainer_5 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.Light
                        FillPortions: =0
                        Height: =48
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGap: =10
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =8
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =8
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Visible: |-
                            =TipoDevolucaoDropdown.Selected.Value in [
                                'Tipo de RMA'.'Devolução de Empréstimo',
                                'Tipo de RMA'.Manutenção,
                                'Tipo de RMA'.'Devolução Definitiva do Produto',
                                'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                'Tipo de RMA'.'Retorno Para Troca de Produto'
                            ]
                        ZIndex: =7

                        FormRowLabelText_5 As Text:
                            Align: ='TextCanvas.Align'.Start
                            AutoHeight: =false
                            BorderColor: =
                            BorderStyle: =""
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Fill: =
                            FillPortions: =1
                            Font: =Font.Lato
                            FontColor: =
                            FontItalic: =false
                            FontStrikethrough: =false
                            FontUnderline: =false
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =190
                            PaddingLeft: =10
                            PaddingRight: =10
                            Size: =14
                            TabIndex: =0
                            Text: ="Número de Série"
                            Tooltip: =""
                            VerticalAlign: =VerticalAlign.Middle
                            Visible: =true
                            Weight: ='TextCanvas.Weight'.Bold
                            Width: =200
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =1

                        "SNTextInput As 'Text input'":
                            BasePaletteColor: =
                            BorderColor: =
                            DisplayMode: =If(NovoCadastro = true,DisplayMode.Edit,DisplayMode.View)
                            Fill: =
                            FillPortions: =1
                            Font: =Font.Lato
                            FontColor: =
                            Height: =32
                            LayoutMaxHeight: =0
                            LayoutMaxWidth: =0
                            LayoutMinHeight: =16
                            LayoutMinWidth: =16
                            OnChange: =Set(_SN,Self.Value)
                            Value: =_SN
                            Width: =320
                            X: =0
                            Y: =0
                            ZIndex: =2

                    SaveButton As Button:
                        BasePaletteColor: =
                        BorderColor: =
                        DisplayMode: |-
                            =If(
                                NovoCadastro = true,
                                Switch(
                                    TipoDevolucaoDropdown.Selected.Value,
                                    'Tipo de RMA'.'Devolução de Empréstimo',
                                    If(
                                        And(
                                            !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                            With(
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    {
                                                        Emprestimo: E.'Produto-Serviço'.'É Empréstimo',
                                                        Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido'
                                                    }
                                                ) As Prod,
                                                And(
                                                    Prod.Emprestimo = 'É Empréstimo (Produtos-Serviço)'.Yes,
                                                    Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes
                                                )
                                            )
                                        ),
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    ),
                                    'Tipo de RMA'.Manutenção,
                                    If(
                                        And(
                                            !IsBlank(ProdutoNovoCombobox.Selected.'Estoque From SharepointList'),
                                            With(
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoNovoCombobox.Selected.'Estoque From SharepointList',
                                                    {Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido'}
                                                ) As Prod,
                                                Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes
                                            ),
                                            !IsBlank(OSComboboxCanvas.Selected.'Ordem de Serviço Field Control'),
                                            Or(
                                                Len(TrimEnds(_SN)) > 3,
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoNovoCombobox.Selected.'Estoque From SharepointList',
                                                    E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                )
                                            )
                                        ),
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    ),
                                    'Tipo de RMA'.'Devolução Definitiva do Produto',
                                    If(
                                        And(
                                            !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                            With(
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    {
                                                        Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido',
                                                        Fornecimento: E.'Produto-Serviço'.'Opção de Fornecimento'
                                                    }
                                                ) As Prod,
                                                And(
                                                    Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                    Prod.Fornecimento = 'Opção de Fornecimento'.Padrão
                                                )
                                            ),
                                            Or(
                                                Len(TrimEnds(_SN)) > 3,
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                )
                                            ),
                                            !IsBlank(ProdutoNovoCombobox.Selected)
                                        ),
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    ),
                                    'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                    If(
                                        And(
                                            !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                            With(
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    {
                                                        Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido',
                                                        Fornecimento: E.'Produto-Serviço'.'Opção de Fornecimento',
                                                        Emprestimo: E.'Produto-Serviço'.'É Empréstimo'
                                                    }
                                                ) As Prod,
                                                And(
                                                    Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                    Prod.Fornecimento = 'Opção de Fornecimento'.Padrão,
                                                    Prod.Emprestimo <> 'É Empréstimo (Produtos-Serviço)'.Yes
                                                )
                                            ),
                                            Or(
                                                Len(TrimEnds(_SN)) > 3,
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                )
                                            )
                                        ),
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    ),
                                    'Tipo de RMA'.'Retorno Para Troca de Produto',
                                    If(
                                        And(
                                            !IsBlank(ProdutoAntigoCombobox.Selected.'Estoque From SharepointList'),
                                            With(
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    {
                                                        Devolvido: E.'Produto-Serviço'.'Empréstimo Devolvido',
                                                        Fornecimento: E.'Produto-Serviço'.'Opção de Fornecimento',
                                                        Emprestimo: E.'Produto-Serviço'.'É Empréstimo'
                                                    }
                                                ) As Prod,
                                                And(
                                                    Prod.Devolvido <> 'Empréstimo Devolvido (Produtos-Serviço)'.Yes,
                                                    Prod.Fornecimento = 'Opção de Fornecimento'.Padrão,
                                                    Prod.Emprestimo <> 'É Empréstimo (Produtos-Serviço)'.Yes
                                                )
                                            ),
                                            Or(
                                                Len(TrimEnds(_SN)) > 3,
                                                LookUp(
                                                    'Estoque From SharepointLists' As E,
                                                    E.'Estoque From SharepointList' = ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                                    E.'Modelo de Produto'.'Controla S/N' <> 'Controla S/N (Modelos de Produto From Sharepoint Lists)'.Yes
                                                )
                                            ),
                                            AprovarVendaToggle.Checked = true
                                        ),
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    ),
                                    DisplayMode.Disabled
                                ),
                                DisplayMode.View
                            )
                        Font: =Font.Lato
                        FontColor: =
                        Height: =32
                        LayoutMaxHeight: =0
                        LayoutMaxWidth: =0
                        LayoutMinHeight: =16
                        LayoutMinWidth: =16
                        OnSelect: |-
                            =UpdateContext({SpinCounter: SpinCounter + 1});
                            Switch(
                                TipoDevolucaoDropdown.Selected.Value,
                                'Tipo de RMA'.'Devolução de Empréstimo',
                                '(Estoque-RMA)-Registrardevoluçãodeempréstimo'.Run(
                                    ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                    RMASelecionado.RMA,
                                    AprovarVendaToggle.Checked
                                ),
                                'Tipo de RMA'.Manutenção,
                                '(Estoque-RMA)-Registrarretornodeprodutoparamanutenção'.Run(
                                    ProdutoNovoCombobox.Selected.'Estoque From SharepointList',
                                    RMASelecionado.RMA,
                                    OSComboboxCanvas.Selected.'Ordem de Serviço Field Control',
                                    _SN
                                ),
                                'Tipo de RMA'.'Devolução Definitiva do Produto',
                                '(Estoque-RMA)-Registrardevoluçãodefinitivadeprodutovendido'.Run(
                                    ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                    RMASelecionado.RMA,
                                    AprovarVendaToggle.Checked,
                                    _SN,
                                    ProdutoNovoCombobox.Selected.'Estoque From SharepointList'
                                ),
                                'Tipo de RMA'.'Retorno Temporário ao Estoque',
                                '(Estoque-RMA)-Registrarretornotemporáriodeprodutoaoestoque'.Run(
                                    ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                    RMASelecionado.RMA,
                                    _SN
                                ),
                                'Tipo de RMA'.'Retorno Para Troca de Produto',
                                '(Estoque-RMA)-Registrarretornoparatrocadeproduto'.Run(
                                    ProdutoAntigoCombobox.Selected.'Estoque From SharepointList',
                                    RMASelecionado.RMA,
                                    _SN,
                                    AprovarVendaToggle.Checked
                                ),
                                false
                            );
                            Select(RefreshButton);
                            Reset(TipoDevolucaoDropdown);
                            Reset(ProdutoAntigoCombobox);
                            Reset(AprovarVendaToggle);
                            Reset(ProdutoNovoCombobox);
                            Set(
                                _SN,
                                Blank()
                            );
                            UpdateContext({SpinCounter: SpinCounter - 1})
                        Text: ="Registrar Retorno"
                        Width: =96
                        X: =0
                        Y: =0
                        ZIndex: =8

    "Spinner1 As 'Fluent Spinner (1.1.29) Preview'":
        BackgroundColor: |-
            ="#00000050"
        DisplayMode: =DisplayMode.Edit
        Height: =Parent.Height
        Label: ="Carregando..."
        SpinnerSize: ='PowerCAT.Spinner.SpinnerSize'.Large
        Theme: =AppThemeJson
        Visible: =SpinCounter > 0
        Width: =Parent.Width
        X: =0
        Y: =0
        ZIndex: =2

    ButtonCanvas1 As Button:
        BasePaletteColor: =
        BorderColor: =
        DisplayMode: =DisplayMode.Edit
        FontColor: =
        Height: =32
        OnSelect: |-
            =Set(
                RMAId,
                Last(RMAS).RMA
            );
            Reset(ProjetoComboboxCanvas);
            Reset(OSComboboxCanvas)
        Text: ="TESTE"
        Visible: =false
        Width: =96
        X: =564
        Y: =72
        ZIndex: =3

