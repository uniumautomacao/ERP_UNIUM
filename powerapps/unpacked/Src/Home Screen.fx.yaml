"'Home Screen' As screen":
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |-
        =If(
            IsBlank(SpinCounter),
            UpdateContext({SpinCounter: 0})
        )

    RootLayoutContainer_HS As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(250, 250, 250, 1)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGridColumns: =6
        LayoutGridRows: =6
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =App.Width
        ZIndex: =1

        CommandContainer_HS As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =44
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =3

            "CommandBar1 As 'Fluent Command Bar (1.1.29)'.pcfdataset":
                AlignInContainer: =AlignInContainer.Stretch
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =200
                Items: |-
                    =Table(
                        {
                            ItemKey: "Refresh",
                            ItemIconName: "Refresh",
                            ItemDisplayName: "Atualizar"
                        }
                    )
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                OnSelect: =Select(btn_refreshProdutos)
                Theme: =AppThemeJson
                Width: =600 
                X: =0
                Y: =0
                ZIndex: =1

            CapacityText As Text:
                Align: ='TextCanvas.Align'.Center
                BorderColor: =
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.Lato
                FontColor: =
                Height: =32
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Text: |-
                    ="Capacidade: " & RoundUp(((CountRows(ProdutosPedido) / 2000) * 100),1) & "%"
                VerticalAlign: =VerticalAlign.Middle
                Width: =150
                X: =0
                Y: =0
                ZIndex: =2

            btn_iniciarcotacao As Button:
                AcceptsFocus: =true
                AccessibleLabel: =""
                AlignInContainer: =AlignInContainer.Stretch
                Alignment: ="center"
                BorderColor: =
                BorderRadius: =0
                BorderStyle: =""
                BorderThickness: =0
                ButtonType: ="Primary"
                ContentLanguage: =""
                DisabledBorderColor: =
                DisabledFillColor: =
                DisabledTextColor: =
                DisplayMode: =DisplayMode.Edit
                FillColor: =
                FillPortions: =1
                Font: ="'Segoe UI', 'Open Sans', sans-serif"
                FontSize: =10.5
                FontWeight: ="600"
                Height: =32
                HideFromAssistiveTechnologies: =false
                HoverBorderColor: =
                HoverFillColor: =
                HoverTextColor: =
                Italic: =false
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnChange: =false
                OnSelect: |-
                    =UpdateContext({SpinCounter: SpinCounter + 1});
                    With(
                        {
                            Result: ForAll(
                                Distinct(
                                    ProdutosSelecionados,
                                    new_produtoservicoid
                                ),
                                {Result: ThisRecord.Value}
                            )
                        } As ProdIds,
                        With(
                            {
                                Result: Filter(
                                    'Produtos-Serviço' As P,
                                    P.'Produto-Serviço' in ProdIds.Result && IsBlank(P.Cotação)
                                )
                            } As ProdServs,
                            If(
                                CountRows(ProdServs.Result) > 0,
                                With(
                                    {
                                        Result: Patch(
                                            Cotações,
                                            Defaults(Cotações),
                                            {
                                                Fornecedor: LookUp(
                                                    'Fornecedores From Sharepoint Lists' As F,
                                                    F.ID = FornecedorSelecionadoId
                                                )
                                            }
                                        ).Cotação
                                    } As NovaCotacaoId,
                                    If(
                                        !IsBlank(NovaCotacaoId),
                                        With(
                                            {
                                                NovaCotacao: LookUp(
                                                    Cotações,
                                                    Cotação = NovaCotacaoId.Result
                                                ),
                                                Fornecedor: LookUp(
                                                    'Fornecedores From Sharepoint Lists' As F,
                                                    F.ID = FornecedorSelecionadoId
                                                )
                                            } As Results,
                                            /*Relate(
                                                Results.Fornecedor.Cotações,
                                                Results.NovaCotacao
                                            );*/
                                            ForAll(
                                                ProdServs.Result As ProdServ,
                                                /*Relate(
                                                    Results.NovaCotacao.'Produtos-Serviço',
                                                    ProdServ
                                                )*/
                                                Patch(
                                                    'Produtos-Serviço',
                                                    {
                                                        'Produto-Serviço': ProdServ.'Produto-Serviço',
                                                        Cotação: Results.NovaCotacao
                                                    }
                                                )
                                            );
                                            Patch(
                                                Cotações,
                                                Results.NovaCotacao,
                                                {
                                                    'Valor Total': With(
                                                        {
                                                            Result: Filter(
                                                                'Produtos-Serviço',
                                                                Cotação.Cotação = NovaCotacaoId.Result
                                                            )
                                                        } As ProdServRelacionados,
                                                        Sum(
                                                            ProdServRelacionados.Result As Cur,
                                                            Cur.Quantidade * LookUp(
                                                                'Preços de Produtos',
                                                                Status = 'Status (Preços de Produtos)'.Active && 'Modelo de Produto'.'Modelos de Produto From Sharepoint List' = Cur.Produto.'Modelos de Produto From Sharepoint List'
                                                            ).'Preço de Compra'
                                                        )
                                                    )
                                                }
                                            );
                                            Select(btn_refreshProdutos);
                                            Clear(IdsSelecionados);
                                            Launch(
                                                "https://unium.crm2.dynamics.com/main.aspx?appid=3ec4d8a9-2a8e-ee11-8179-002248de6f66&forceUCI=1&pagetype=entityrecord&etn=new_cotacao&id=" & NovaCotacaoId.Result,
                                                Blank(),
                                                LaunchTarget.New
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    );
                    UpdateContext({SpinCounter: SpinCounter - 1})
                PaddingBottom: =0
                PaddingEnd: =0
                PaddingStart: =0
                PaddingTop: =0
                PressedBorderColor: =
                PressedFillColor: =
                PressedTextColor: =
                Strikethrough: =false
                TabIndex: =0
                Text: ="btn_iniciarcotacao"
                TextColor: =
                Tooltip: =""
                Underline: =false
                VerticalAlignment: ="middle"
                Visible: =false
                Width: =96
                X: =0
                Y: =0
                ZIndex: =3

            btn_refreshProdutos As Button:
                BasePaletteColor: =
                BorderColor: =
                DisplayMode: =DisplayMode.Edit
                FontColor: =
                Height: =32
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnSelect: |-
                    =Concurrent(
                        Refresh('Produtos-Serviço'),
                        Refresh('Modelos de Produto From Sharepoint Lists'),
                        Refresh('Fabricantes From Sharpoint Lists'),
                        Refresh('Preços de Produtos'),
                        Refresh(Cotações),
                        Refresh(AppPreferences),
                        Refresh(Users)
                    );/*
                    ClearCollect(
                        ProdutosFornecedor,
                        AddColumns(
                            GroupBy(
                                Filter(
                                    ProdutosPedido As P,
                                    P.new_fornecedorprincipalid = FornecedorSelecionadoId
                                ),
                                new_nomedoclientefx,
                                new_referenciadoproduto,
                                new_entregaproxima,
                                new_produtoservicoid,
                                new_previsaodeentrega,
                                new_descricao,
                                new_fornecedorprincipalid,
                                new_nomedofabricantev2,
                                Produtos
                            ) As Prods,
                            new_quantidade,
                            Sum(
                                Prods.Produtos As P,
                                P.new_quantidade
                            ),
                            DataEntrega,
                            Text(
                                Prods.new_previsaodeentrega,
                                DateTimeFormat.ShortDate,
                                "pt-BR"
                            ),
                            Selecionado,
                            false
                        )
                    )*/
                Visible: =false
                Width: =96
                X: =0
                Y: =0
                ZIndex: =4

            VersionText As Text:
                Align: ='TextCanvas.Align'.Center
                AutoHeight: =false
                BorderColor: =
                BorderStyle: =""
                ContentLanguage: =""
                DisplayMode: =DisplayMode.Edit
                Fill: =
                Font: =Font.Lato
                FontColor: =
                FontItalic: =false
                FontStrikethrough: =false
                FontUnderline: =false
                Height: =32
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =14
                TabIndex: =0
                Text: ="V0.17"
                Tooltip: =""
                VerticalAlign: =VerticalAlign.Middle
                Visible: =true
                Weight: ="Regular"
                Width: =96
                Wrap: =true
                X: =0
                Y: =0
                ZIndex: =5

        SubheaderContainer_HS As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =70
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =10
            PaddingRight: =10
            ZIndex: =4

            lbTitleCodeReview As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =RGBA(20, 0, 0, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledColor: =RGBA(166, 166, 166, 1)
                FillPortions: =1
                FocusedBorderThickness: =4
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Height: =70
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                PaddingLeft: =20
                Text: ="Compras"
                Width: =240
                Y: =241
                ZIndex: =1

            SearchBox_1 As SearchBox:
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =640
                LayoutMinWidth: =640
                Styles: |-
                    =Table({Name: "PrimaryColor1Value", Value: "#ffffff"},
                    {Name: "PrimaryColor1TextValue", Value: "#292929"},
                    {Name: "PrimaryColor2Value", Value: "#0078d4"},
                    {Name: "PrimaryColor2TextValue", Value: "#ffffff"},
                    {Name: "PrimaryColor3Value", Value: "#303030"},
                    {Name: "PrimaryColor3TextValue", Value: "#080808"},
                    {Name: "PrimaryColor4Value", Value: "#006e7d"},
                    {Name: "defaultLabelColorValue", Value: "#333333"},
                    {Name: "RadiusValue", Value: "0"},
                    {Name: "TextBodyFontFaceValue", Value: "Segoe UI" },
                    {Name: "PaddingValue", Value: "8"},
                    {Name: "TextEmphasisFontSizeValue", Value: "16"},
                    {Name: "TextEmphasisFontSizePhoneValue", Value: "24"},
                    {Name: "TextBodyFontSizeValue", Value: "12"},
                    {Name: "TextBodyFontSizePhoneValue", Value: "21"},
                    {Name: "BackgroundColorValue", Value: "#ffffff"},
                    {Name: "BorderThicknessValue", Value: "0"},
                    {Name: "BorderColorValue", Value: "#FFFFFF"},
                    {Name: "FocusedBorderThicknessValue", Value: "0"},
                    {Name: "BackgroundColorValue", Value :"#FFFFFF"}
                    )
                ZIndex: =2

        ContentContainer_HS As groupContainer.verticalAutoLayoutContainer:
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGridColumns: =6
            LayoutGridRows: =6
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMaxHeight: =
            LayoutMaxWidth: =
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            ZIndex: =5

            BodyContainer As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.Light
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutGap: =20
                LayoutGridColumns: =6
                LayoutGridRows: =6
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMaxHeight: =
                LayoutMaxWidth: =
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                ZIndex: =2

                FirstLaneContainer As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.Light
                    Fill: =ColorValue(AppTheme.palette.neutralLighter)
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGridColumns: =6
                    LayoutGridRows: =6
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingLeft: =10
                    PaddingRight: =10
                    PaddingTop: =10
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    ZIndex: =1

                    FornecedoresText As Text:
                        Align: ='TextCanvas.Align'.Center
                        BorderColor: =
                        DisplayMode: =DisplayMode.Edit
                        Fill: =
                        Font: =Font.Lato
                        FontColor: =
                        Height: =32
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Size: =16
                        Text: ="Fornecedores"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =96
                        X: =0
                        Y: =0
                        ZIndex: =1

                    FornecedoresGallery As gallery.BrowseLayout_Vertical_ThreeTextVariant_pcfCore:
                        '#CopilotOverlayLabel': ="Filtered"
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(166, 166, 166, 1)
                        DelayItemLoading: =true
                        Fill: =RGBA(255, 255, 255, 0)
                        FocusedBorderColor: =RGBA(0, 120, 212, 1)
                        FocusedBorderThickness: =2
                        Items: |-
                            =Search(
                                Fornecedores,
                                SearchBox_1.SearchText,
                                NomeFantasia,
                                RazãoSocial,
                                ID
                            )
                        Layout: =Layout.Vertical
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =287
                        LayoutMinWidth: =320
                        LoadingSpinner: =LoadingSpinner.Data
                        OnSelect: |-
                            =UpdateContext({SpinCounter: SpinCounter + 1});
                            If(
                                FornecedorSelecionadoId <> ThisItem.ID,
                                Clear(IdsSelecionados)
                            );
                            Set(
                                FornecedorSelecionadoId,
                                ThisItem.ID
                            );
                            Select(btn_refreshProdutos);
                            UpdateContext({SpinCounter: SpinCounter - 1})
                        TemplatePadding: =10
                        TemplateSize: =40
                        ZIndex: =5

                        FornecedorContainer As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(AppTheme.palette.neutralLight)
                            BorderThickness: =1
                            DropShadow: =DropShadow.Light
                            Fill: |-
                                =If(
                                    And(
                                        ThisItem.ID = FornecedorSelecionadoId,
                                        !IsBlank(FornecedorSelecionadoId)
                                    ),
                                    ColorValue(AppTheme.palette.neutralLight),
                                    ColorValue(AppTheme.palette.white)
                                )
                            Height: =Parent.TemplateHeight
                            LayoutAlignItems: =LayoutAlignItems.Stretch
                            LayoutGridColumns: =6
                            LayoutGridRows: =6
                            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                            LayoutMode: =LayoutMode.Auto
                            PaddingLeft: =10
                            PaddingRight: =10
                            RadiusBottomLeft: =4
                            RadiusBottomRight: =4
                            RadiusTopLeft: =4
                            RadiusTopRight: =4
                            Width: =Parent.TemplateWidth
                            ZIndex: =1

                            FornecedorTitle As Label:
                                AcceptsFocus: =false
                                Alignment: =Align.Left
                                AutoHeight: =true
                                Color: =
                                ContentLanguage: =""
                                DisplayMode: =DisplayMode.Edit
                                FillPortions: =1
                                Font: =Font.Lato
                                FontSize: =10.5
                                FontWeight: =FontWeight.Semibold
                                Height: =24
                                Italic: =false
                                LayoutMaxHeight: =
                                LayoutMaxWidth: =
                                OnChange: =false
                                OnSelect: =
                                Overflow: ="Hidden"
                                PaddingBottom: =0
                                PaddingEnd: =0
                                PaddingStart: =0
                                PaddingTop: =0
                                Strikethrough: =false
                                TabIndex: =-1
                                Text: =Coalesce(ThisItem.NomeFantasia,ThisItem.RazãoSocial)
                                TextRole: ="Default"
                                Tooltip: =""
                                Underline: =false
                                VerticalAlignment: =VerticalAlign.Middle
                                Visible: =true
                                Width: =
                                Wrap: =true
                                X: =12
                                Y: =
                                ZIndex: =1

                            FornecedorCounter As Label:
                                AcceptsFocus: =false
                                Alignment: =Align.Right
                                AutoHeight: =true
                                Color: =
                                ContentLanguage: =""
                                DisplayMode: =DisplayMode.Edit
                                FillPortions: =1
                                Font: =Font.Lato
                                FontSize: =10.5
                                FontWeight: =FontWeight.Normal
                                Height: =24
                                Italic: =false
                                LayoutMaxHeight: =
                                LayoutMaxWidth: =
                                OnChange: =false
                                OnSelect: =
                                Overflow: ="Hidden"
                                PaddingBottom: =0
                                PaddingEnd: =0
                                PaddingStart: =0
                                PaddingTop: =0
                                Strikethrough: =false
                                TabIndex: =-1
                                Text: =ThisItem.Counter
                                TextRole: ="Default"
                                Tooltip: =""
                                Underline: =false
                                VerticalAlignment: =VerticalAlign.Middle
                                Visible: =true
                                Width: =
                                Wrap: =true
                                X: =12
                                Y: =
                                ZIndex: =2

                        Rectangle2 As rectangle:
                            BorderColor: =RGBA(166, 166, 166, 1)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            DisabledFill: =RGBA(166, 166, 166, 0)
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =RGBA(0, 120, 212, 1)
                            Height: =Parent.TemplateHeight
                            HoverFill: =RGBA(0, 120, 212, 0)
                            OnSelect: =Select(Parent)
                            PressedFill: =RGBA(0, 120, 212, 0)
                            Width: =Parent.TemplateWidth
                            ZIndex: =2

                SecondLaneContainer As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.Light
                    Fill: =ColorValue(AppTheme.palette.neutralLighter)
                    FillPortions: =2
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGridColumns: =6
                    LayoutGridRows: =6
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMaxHeight: =
                    LayoutMaxWidth: =
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingLeft: =10
                    PaddingRight: =10
                    PaddingTop: =10
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    ZIndex: =3

                    ProdutosText As Text:
                        Align: ='TextCanvas.Align'.Center
                        AutoHeight: =false
                        BorderColor: =
                        BorderStyle: =""
                        ContentLanguage: =""
                        DisplayMode: =DisplayMode.Edit
                        Fill: =
                        Font: =Font.Lato
                        FontColor: =
                        FontItalic: =false
                        FontStrikethrough: =false
                        FontUnderline: =false
                        Height: =32
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =32
                        LayoutMinWidth: =96
                        Size: =16
                        TabIndex: =0
                        Text: ="Produtos p/ pedido"
                        Tooltip: =""
                        VerticalAlign: =VerticalAlign.Middle
                        Visible: =!IsBlank(FornecedorSelecionadoId)
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =96
                        Wrap: =true
                        X: =0
                        Y: =0
                        ZIndex: =1

                    ProdutosContainer As groupContainer.verticalAutoLayoutContainer:
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        LayoutGridColumns: =6
                        LayoutGridRows: =6
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMaxHeight: =
                        LayoutMaxWidth: =
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Visible: =ProdutosText.Visible
                        ZIndex: =3

                        "CommandBar2 As 'Fluent Command Bar (1.1.29)'.pcfdataset":
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Items: |-
                                =Table(
                                    {
                                        ItemKey: "Fechar",
                                        ItemIconName: "Cancel",
                                        ItemDisplayName: "Fechar",
                                        ItemVisible: true
                                    },
                                    {
                                        ItemKey: "SelecionarTudo",
                                        ItemIconName: "SelectAll",
                                        ItemDisplayName: "Selecionar Tudo",
                                        ItemVisible: CountRows(ProdutosSelecionados) <> CountRows(ProdutosFornecedor)
                                    },
                                    {
                                        ItemKey: "DeselecionarTudo",
                                        ItemIconName: "ClearSelection",
                                        ItemDisplayName: "Limpar Seleção",
                                        ItemVisible: CountRows(ProdutosSelecionados) > 0
                                    },
                                    {
                                        ItemKey: "Iniciar Cotação",
                                        ItemIconName: "ShoppingCart",
                                        ItemDisplayName: "Iniciar Cotação",
                                        ItemVisible: And(
                                            CountRows(ProdutosSelecionados) > 0,
                                            ProdutosDList.Visible
                                        )
                                    }
                                )
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            OnSelect: |-
                                =Switch(
                                    Self.Selected.ItemKey,
                                    "Iniciar Cotação",
                                    Select(btn_iniciarcotacao),
                                    "Fechar",
                                    Concurrent(
                                        Set(
                                            FornecedorSelecionadoId,
                                            Blank()
                                        ),
                                        Clear(IdsSelecionados)
                                    ),
                                    "SelecionarTudo",
                                    ClearCollect(
                                        IdsSelecionados,
                                        ForAll(
                                            ProdutosFornecedor As P,
                                            P.new_produtoservicoid
                                        )
                                    ),
                                    "DeselecionarTudo",
                                    Clear(IdsSelecionados),
                                    false
                                )
                            Theme: =AppThemeJson
                            Visible: =true
                            Width: =200
                            X: =40
                            Y: =40
                            ZIndex: =1

                        "ProdutosDList As 'Fluent Details List (1.1.29)'.pcfdataset":
                            columns_Items: |-
                                =[
                                    {
                                        ColName: "IconeSelecionado",
                                        ColDisplayName: "",
                                        ColCellType: "clickableimage",
                                        ColWidth: 40,
                                        ColTagColorColumn: "TagColor",
                                        ColVerticalAlign: "Center",
                                        ColHorizontalAlign: "Center",
                                        ColResizable: true
                                    },
                                    {
                                        ColDisplayName: "Quant.",
                                        ColName: "new_quantidade",
                                        ColWidth: 100
                                    },
                                    {
                                        ColDisplayName: "Cliente",
                                        ColName: "new_nomedoclientefx",
                                        ColWidth: 100
                                    },
                                    {
                                        ColDisplayName: "Ref",
                                        ColName: "new_referenciadoproduto",
                                        ColWidth: 100
                                    },
                                    {
                                        ColDisplayName: "Descrição",
                                        ColName: "new_descricao",
                                        ColWidth: Self.Width - 400 - 140
                                    },
                                    {
                                        ColDisplayName: "Previsão",
                                        ColName: "PrevisaoEntrega",
                                        ColWidth: 100
                                    }
                                ]
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =1
                            Height: =200
                            Items: |-
                                =AddColumns(
                                    ProdutosFornecedor As P,
                                    IconeSelecionado,
                                    If(
                                        P.Selecionado,
                                        "icon:SkypeCircleCheck",
                                        "icon:CircleRing"
                                    ),
                                    TagColor,
                                    If(
                                        P.Selecionado,
                                        AppTheme.palette.themePrimary,
                                        AppTheme.palette.neutralPrimary
                                    ),
                                    PrevisaoEntrega,
                                    Text(
                                        P.new_previsaodeentrega,
                                        DateTimeFormat.ShortDate,
                                        "pt-BR"
                                    )
                                )
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            OnChange: |-
                                =Set(
                                    Debug,
                                    Self.EventRowKey
                                );
                                If(
                                    And(
                                        Self.EventName = "CellAction",
                                        Self.EventColumn = "IconeSelecionado",
                                        !IsBlank(Self.EventRowKey)
                                    ),
                                    With(
                                        {Value: GUID(Self.EventRowKey)} As Key,
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    IdsSelecionados As Id,
                                                    Id.Value = Key.Value
                                                )
                                            ),
                                            Collect(
                                                IdsSelecionados,
                                                Key
                                            ),
                                            Remove(
                                                IdsSelecionados,
                                                Key
                                            )
                                        )
                                    )
                                )
                            OnSelect: =
                            RecordKey: ="new_produtoservicoid"
                            RecordSelected: ="Selecionado"
                            SelectionType: ='PowerCAT.FluentDetailsList.SelectionType'.None
                            SelectRowsOnFocus: =true
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =3

                            "new_quantidade2 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="new_quantidade"
                                FieldName: ="new_quantidade"
                                FieldType: ="n"
                                FieldVariantName: ="textualColumn"
                                Order: =1
                                ZIndex: =1

                            "new_nomedoclientefx2 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="new_nomedoclientefx"
                                FieldName: ="new_nomedoclientefx"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =2
                                ZIndex: =2

                            "new_referenciadoproduto2 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="new_referenciadoproduto"
                                FieldName: ="new_referenciadoproduto"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =3
                                ZIndex: =3

                            "new_descricao2 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="new_descricao"
                                FieldName: ="new_descricao"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =4
                                ZIndex: =4

                            "IconeSelecionado1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="IconeSelecionado"
                                FieldName: ="IconeSelecionado"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =5
                                ZIndex: =5

                            "TagColor1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="TagColor"
                                FieldName: ="TagColor"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =6
                                ZIndex: =6

                            "PrevisaoEntrega1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="PrevisaoEntrega"
                                FieldName: ="PrevisaoEntrega"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =7
                                ZIndex: =7

                            "DataEntrega1 As 'cat_PowerCAT.FluentDetailsListTemplate_dataField'.textualColumn":
                                FieldDisplayName: ="DataEntrega"
                                FieldName: ="DataEntrega"
                                FieldType: ="s"
                                FieldVariantName: ="textualColumn"
                                Order: =8
                                ZIndex: =8

                        lbl_produtosParaCompra_ValorTotal As Label:
                            AcceptsFocus: =false
                            Alignment: =Align.Left
                            AutoHeight: =true
                            Color: =RGBA(0, 0, 0, 1)
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Font: ="'Segoe UI', 'Open Sans', sans-serif"
                            FontSize: =12
                            FontWeight: =FontWeight.Semibold
                            Height: =
                            Italic: =false
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            LayoutMinHeight: =32
                            LayoutMinWidth: =320
                            OnChange: =false
                            OnSelect: =
                            Overflow: ="Hidden"
                            PaddingBottom: =0
                            PaddingEnd: =0
                            PaddingStart: =10
                            PaddingTop: =0
                            Strikethrough: =false
                            TabIndex: =0
                            Text: |-
                                ="Valor Total: "&With(
                                                {
                                                    Result: ForAll(Distinct(
                                                        ProdutosSelecionados As X,
                                                        X.new_produtoservicoid
                                                    ), {Result: ThisRecord.Value})
                                                } As SelecaoIds,
                                                With(
                                                    {
                                                        Result: Filter(
                                                            'Produtos-Serviço',
                                                            'Produto-Serviço' in SelecaoIds.Result
                                                        )
                                                    } As Selecao,
                                                    Text(
                                                        Sum(
                                                            Selecao.Result As Prod,
                                                            LookUp(
                                                                'Preços de Produtos' As Prec,
                                                                Prec.'Modelo de Produto'.'Modelos de Produto From Sharepoint List' = Prod.Produto.'Modelos de Produto From Sharepoint List'
                                                            ).'Preço de Compra' * Prod.Quantidade
                                                        ),
                                                        "[$-pt-BR]R$#.##0,00"
                                                    )
                                                )
                                            )
                            TextRole: ="Default"
                            Tooltip: =""
                            Underline: =false
                            VerticalAlignment: ="middle"
                            Visible: =CountRows(ProdutosSelecionados) > 0
                            Width: =320
                            Wrap: =true
                            X: =0
                            Y: =0
                            ZIndex: =4

                        SummaryButton As Button:
                            AcceptsFocus: =true
                            AccessibleLabel: =""
                            Alignment: ="center"
                            BorderColor: =
                            BorderRadius: =0
                            BorderStyle: =""
                            BorderThickness: =0
                            ButtonType: ="Primary"
                            ContentLanguage: =""
                            DisabledBorderColor: =
                            DisabledFillColor: =
                            DisabledTextColor: =
                            DisplayMode: =DisplayMode.Edit
                            FillColor: =
                            Font: ="'Segoe UI', 'Open Sans', sans-serif"
                            FontSize: =10.5
                            FontWeight: ="600"
                            Height: =32
                            HideFromAssistiveTechnologies: =false
                            HoverBorderColor: =
                            HoverFillColor: =
                            HoverTextColor: =
                            Italic: =false
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            OnChange: =false
                            OnSelect: |-
                                =UpdateContext({ShowPrintSummaryWindow: If(ShowPrintSummaryWindow,false,true)})
                            PaddingBottom: =0
                            PaddingEnd: =0
                            PaddingStart: =0
                            PaddingTop: =0
                            PressedBorderColor: =
                            PressedFillColor: =
                            PressedTextColor: =
                            Strikethrough: =false
                            TabIndex: =0
                            Text: ="Imprimir Resumo"
                            TextColor: =
                            Tooltip: =""
                            Underline: =false
                            VerticalAlignment: ="middle"
                            Visible: =lbl_produtosParaCompra_ValorTotal.Visible
                            Width: =96
                            X: =0
                            Y: =0
                            ZIndex: =5

                        PCFCopyTextComponent1 As PCFCopyTextComponent:
                            ButtonBackgroundColor: ="RGBA(56,96,178,1)"
                            ButtonBorderColor: ="RGBA(56,96,178,1)"
                            ButtonBorderRadius: =10
                            ButtonBorderThickness: =2
                            ButtonColor: ="RGBA(255,255,255,1)"
                            ButtonFontFamily: ="Open Sans"
                            ButtonFontSize: =15
                            ButtonFontWeight: ="Semibold"
                            ContentLanguage: =""
                            DisplayMode: =DisplayMode.Edit
                            Height: =40
                            InputBackgroundColor: ="RGBA(255,255,255,1)"
                            InputBorderColor: ="RGBA(0,18,107,1)"
                            InputBorderRadius: =5
                            InputBorderThickness: =2
                            InputColor: ="RGBA(0,0,0,1)"
                            InputFontFamily: ="Open Sans"
                            InputFontSize: =13
                            InputFontWeight: ="Normal"
                            LayoutMaxHeight: =
                            LayoutMaxWidth: =
                            LayoutMinHeight: =200
                            LayoutMinWidth: =200
                            MaxLength: =255
                            MultiLine: =false
                            OnChange: |-
                                =UpdateContext({ShowPrintSummaryWindow: If(ShowPrintSummaryWindow,false,true)})
                            Placeholder: =""
                            ReadOnly: =false
                            TabIndex: =0
                            Tooltip: ="This component includes a textbox with a button next to it.  When you click the button it copies the contents of the textbox to the clipboard."
                            Value: |-
                                =Concat(
                                    ForAll(
                                        SortByColumns(
                                            GroupBy(
                                                ProdutosSelecionados,
                                                new_referenciadoproduto,
                                                Items
                                            ),
                                            "new_referenciadoproduto",
                                            SortOrder.Ascending
                                        ) As Group,
                                        Concatenate(
                                            Sum(
                                                Group.Items As I,
                                                I.new_quantidade
                                            ),
                                            "x ",
                                            Group.new_referenciadoproduto
                                        )
                                    ) As Cur,
                                    Cur.Value,
                                    Char(13)
                                )
                            Visible: =And(ShowPrintSummaryWindow,SummaryButton.Visible)
                            Width: =200
                            X: =0
                            Y: =0
                            ZIndex: =6

    "Spinner1 As 'Fluent Spinner (1.1.29) Preview'":
        BackgroundColor: |-
            ="#00000050"
        DisplayMode: =DisplayMode.Edit
        Height: =Parent.Height
        Label: ="Carregando..."
        SpinnerSize: ='PowerCAT.Spinner.SpinnerSize'.Large
        Theme: =AppThemeJson
        Visible: =Or(SpinCounter > 0, Not(CountRows(Fornecedores) > 0))
        Width: =Parent.Width
        X: =0
        Y: =0
        ZIndex: =2

